IF NOT DEFINED VERCODE EXIT
CALL :%1 %2 %3 %4
EXIT /B 0

:SLOWDOWN <"Enemy": Integer> <"Amount": Integer>
SET /A AV.%1+=%2
EXIT /B 0

:POISON-CREATE <"Enemy/Player": Integer/String> <"Turns": Integer> <"Power": Integer>
SET EFF.POISON.%1=%2
SET EFF.POISON.%1.POWER=%3
EXIT /B 0
:POISON-EFFECT
FOR /F "TOKENS=3,4DELIMS=.=" %%1 IN ('SET EFF.POISON.') DO (
	IF NOT %%2==POWER IF %%1==PLAYER (
	:: POISON for player
		SET /A EFF.POISON.%%1-=1
		SETLOCAL ENABLEDELAYEDEXPANSION
		IF %PLAYER.HP.NOW% LEQ 0 (
			ENDLOCAL
				SET PLAYER.HP.NOW=0
				SET EFF.POISON.%%1=
				SET EFF.POISON.%%1.POWER=
		) ELSE (
			ENDLOCAL
			SET /A EFF.POISON.%%1-=1
			SET /A PLAYER.HP.NOW-=EFF.POISON.%%1.POWER
		)
	) ELSE (
		:: Poison for any enemy
		SETLOCAL ENABLEDELAYEDEXPANSION
		IF NOT %%2==POWER IF NOT !ENEMY.HP.NOW.%%1! EQU 0 (
			ENDLOCAL
			SET /A "TMP.DMG=(((50 * SKILL.ATK) + EQUIP.BONUS_ATK + EFFECT.BONUS_ATK) *EFF.POISON.%%1.POWER) / 100"
			SET /A EFF.POISON.%%1-=1
			SET /A ENEMY.HP.NOW.%%1-=%TMP.DMG%

			:: Make sure that the enemy doesn't have less than 0 HP.
			SETLOCAL ENABLEDELAYEDEXPANSION
			SET /A ENEMY.HP.NOW.%%1=!ENEMY.HP.NOW.%%1! - %TMP.DMG%
			IF !ENEMY.HP.NOW.%%1! LEQ 0 (
				ENDLOCAL
				SET ENEMY.HP.NOW.%%1=0
				SET EFF.POISON.%%1=
			) ELSE IF !EFF.POISON.%%1! LEQ 0 (
				ENDLOCAL
				SET EFF.POISON.%%1=
			) ELSE ENDLOCAL
		) ELSE ENDLOCAL
	)
)
EXIT /B 0

:FIRE-CREATE <"Enemy/Player": Integer/String> <"Turns": Integer> <"Power": Integer>
SET EFF.FIRE.%1=%2
SET EFF.FIRE.%1.POWER=%3
EXIT /B 0
:FIRE-EFFECT
FOR /F "TOKENS=3,4DELIMS=.=" %%1 IN ('SET EFF.FIRE.') DO (
	IF NOT %%2==POWER IF %%1==PLAYER (
	:: Fire for player
		SET /A EFF.FIRE.%%1-=1
		SETLOCAL ENABLEDELAYEDEXPANSION
		IF %PLAYER.HP.NOW% LEQ 0 (
			ENDLOCAL
				SET PLAYER.HP.NOW=0
				SET EFF.FIRE.%%1=
				SET EFF.FIRE.%%1.POWER=
		) ELSE (
			ENDLOCAL
			SET /A EFF.FIRE.%%1-=1
			SET /A PLAYER.HP.NOW-=EFF.FIRE.%%1.POWER
		)
	) ELSE (
	:: Fire for any enemy
		SETLOCAL ENABLEDELAYEDEXPANSION
		IF NOT %%2==POWER IF NOT !ENEMY.HP.NOW.%%1! EQU 0 (
			ENDLOCAL
			SET /A "TMP.DMG=(((50 * SKILL.ATK) + EQUIP.BONUS_ATK + EFFECT.BONUS_ATK) *EFF.FIRE.%%1.POWER) / 100"
			SET /A EFF.FIRE.%%1-=1
			SET /A ENEMY.HP.NOW.%%1-=%TMP.DMG%

			:: Make sure that the enemy doesn't have less than 0 HP.
			SETLOCAL ENABLEDELAYEDEXPANSION
			TITLE !EFF.FIRE.%%1!
			SET /A ENEMY.HP.NOW.%%1=!ENEMY.HP.NOW.%%1! - %TMP.DMG%
			IF !ENEMY.HP.NOW.%%1! LEQ 0 (
				ENDLOCAL
				SET ENEMY.HP.NOW.%%1=0
				SET EFF.FIRE.%%1=
				SET EFF.FIRE.%%1.POWER=
			) ELSE IF !EFF.FIRE.%%1! LEQ 0 (
				ENDLOCAL
				SET EFF.FIRE.%%1=
				SET EFF.FIRE.%%1.POWER=
			) ELSE ENDLOCAL
		) ELSE ENDLOCAL
	)
)
EXIT /B 0