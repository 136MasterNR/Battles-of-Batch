IF NOT DEFINED VERCODE EXIT
FOR /L %%I IN (1,1,%EN.MAX%) DO (
	CALL :CREATE-LOCATION %%I %%LOC.W%%I%% %%LOC.H%%I%%
)
ECHO.[u 45%%
SET "ADD-CMD=::Controlled by the debug mode"
SET "CNT.FADEOUT=0"
SET FADE=
SET TMP.LOC_HP_OLD=
SET ENEMY.ATK.DEALT=0
SET "PLAYER.HP.NOW=NUL"
SET "PLAYER.ATTACK.ENEMY=NONE"
SET PLAYER.ATTACK.AMOUNT=0
SET CNT=1
FOR /F "TOKENS=1 DELIMS==" %%A IN ('SET ENEMY.HP.NOW.') DO (
	SET /A %%A=0
)
SET /A "PLAYER.HP.FULL=100*%SKILL.HP%"
SET "PLAYER.ATTACK.ENEMY.R=NONE"
SET "GAME.STATUS=NUL"
SET ENEMY.ATTACK.AMOUNT=0
SET "HEAL.USES.NOW=%HEAL.USES%"
SET "BOMB.USES.NOW=%BOMB.USES%"
ECHO.[u 49%%
::HP Bar Setup
FOR /L %%I IN (1,1,%EN.MAX%) DO (
	SETLOCAL ENABLEDELAYEDEXPANSION
	FOR /F "TOKENS=1-2 DELIMS=," %%A IN ("!ENEMY.HP.AMOUNT.%%I!") DO (
		ENDLOCAL
		CALL :RAND %%I %%A %%B
	)
)
SET ENEMY.HP.FULL.T=0
FOR /F "TOKENS=4,5 DELIMS=.=" %%1 IN ('SET ENEMY.HP.NOW.') DO (
	IF %%2 GTR 0 (
		SET ENEMY.HP.FULL.%%1=%%2
		SET /A ENEMY.HP.FULL.T+=%%2
	)
)
SET PLAYER.HP.NOW=%PLAYER.HP.FULL%
SET PLAYER.HEAL.AMOUNT=0
ECHO.[u 51%%
::ENEMIES
FOR /L %%I IN (1,1,%EN.MAX%) DO (
	FOR /L %%X IN (90,-10,10) DO CALL :CREATE-HPBAR %%I %%X %%ENEMY.HP.FULL.%%I%%
	IF %%I EQU 1 ECHO.[u 53%%
	IF %%I EQU 2 ECHO.[u 55%%
)
ECHO.[u 58%%
::PLAYER
::P-90
SET /A "PLAYER.HOLO.HP.90=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.90=%PLAYER.HOLO.HP.90%*10"
SET /A "PLAYER.HOLO.HP.90=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.90%"
SET /A "PLAYER.HOLO.HP.90=%PLAYER.HOLO.HP.90%/100"
::P-80
SET /A "PLAYER.HOLO.HP.80=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.80=%PLAYER.HOLO.HP.80%*20"
SET /A "PLAYER.HOLO.HP.80=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.80%"
SET /A "PLAYER.HOLO.HP.80=%PLAYER.HOLO.HP.80%/100"
::P-70
SET /A "PLAYER.HOLO.HP.70=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.70=%PLAYER.HOLO.HP.70%*30"
SET /A "PLAYER.HOLO.HP.70=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.70%"
SET /A "PLAYER.HOLO.HP.70=%PLAYER.HOLO.HP.70%/100"
::P-60
SET /A "PLAYER.HOLO.HP.60=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.60=%PLAYER.HOLO.HP.60%*40"
SET /A "PLAYER.HOLO.HP.60=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.60%"
SET /A "PLAYER.HOLO.HP.60=%PLAYER.HOLO.HP.60%/100"
::P-50
SET /A "PLAYER.HOLO.HP.50=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.50=%PLAYER.HOLO.HP.50%*50"
SET /A "PLAYER.HOLO.HP.50=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.50%"
SET /A "PLAYER.HOLO.HP.50=%PLAYER.HOLO.HP.50%/100"
::P-40
SET /A "PLAYER.HOLO.HP.40=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.40=%PLAYER.HOLO.HP.40%*60"
SET /A "PLAYER.HOLO.HP.40=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.40%"
SET /A "PLAYER.HOLO.HP.40=%PLAYER.HOLO.HP.40%/100"
::P-30
SET /A "PLAYER.HOLO.HP.30=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.30=%PLAYER.HOLO.HP.30%*70"
SET /A "PLAYER.HOLO.HP.30=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.30%"
SET /A "PLAYER.HOLO.HP.30=%PLAYER.HOLO.HP.30%/100"
::P-20
SET /A "PLAYER.HOLO.HP.20=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.20=%PLAYER.HOLO.HP.20%*80"
SET /A "PLAYER.HOLO.HP.20=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.20%"
SET /A "PLAYER.HOLO.HP.20=%PLAYER.HOLO.HP.20%/100"
::P-10
SET /A "PLAYER.HOLO.HP.10=%PLAYER.HP.FULL%00/100"
SET /A "PLAYER.HOLO.HP.10=%PLAYER.HOLO.HP.10%*90"
SET /A "PLAYER.HOLO.HP.10=%PLAYER.HP.FULL%00-%PLAYER.HOLO.HP.10%"
SET /A "PLAYER.HOLO.HP.10=%PLAYER.HOLO.HP.10%/100"
::P-00
SET A_1=
SET A_2=
SET B_1=
SET B_2=
SET C_1=
SET C_2=
IF NOT %ENEMY.HP.NOW.2%==0 SET "A_1=IF %ENEMY.HP.NOW.1% LSS %ENEMY.HP.NOW.2% "
IF NOT %ENEMY.HP.NOW.3%==0 SET "A_2=IF %ENEMY.HP.NOW.1% LSS %ENEMY.HP.NOW.3% "
IF NOT %ENEMY.HP.NOW.1%==0 SET "B_1=IF %ENEMY.HP.NOW.2% LSS %ENEMY.HP.NOW.1% "
IF NOT %ENEMY.HP.NOW.3%==0 SET "B_2=IF %ENEMY.HP.NOW.2% LSS %ENEMY.HP.NOW.3% "
IF NOT %ENEMY.HP.NOW.1%==0 SET "C_1=IF %ENEMY.HP.NOW.3% LSS %ENEMY.HP.NOW.1% "
IF NOT %ENEMY.HP.NOW.2%==0 SET "C_2=IF %ENEMY.HP.NOW.3% LSS %ENEMY.HP.NOW.2% "
IF NOT %ENEMY.HP.NOW.1%==0 %A_1%%A_2%SET INPUTATK=1
IF NOT %ENEMY.HP.NOW.2%==0 %B_1%%B_2%SET INPUTATK=2
IF NOT %ENEMY.HP.NOW.3%==0 %C_1%%C_2%SET INPUTATK=3
EXIT /B 0

:CREATE-LOCATION
SET LOC.EN.%1=[%3;%2H
SET /A TMP=%2-1
SET MOV.EN.%1=[%TMP%C
SET /A TMP=%3-1
SET LOC.HP.%1=[%TMP%;%2H
EXIT /B 0

:CREATE-HPBAR
SET CNT1=%1&SET CNT2=%2&SET TMP_ENEMY.HP.FULL=%3
SET /A "ENEMY.HOLO.HP.%CNT1%.%CNT2%=%TMP_ENEMY.HP.FULL%00/100"&SET /A "ENEMY.HOLO.HP.%CNT1%.%CNT2%=ENEMY.HOLO.HP.%CNT1%.%CNT2%*(100-%CNT2%)"&SET /A "ENEMY.HOLO.HP.%CNT1%.%CNT2%=%TMP_ENEMY.HP.FULL%00-ENEMY.HOLO.HP.%CNT1%.%CNT2%"&SET /A "ENEMY.HOLO.HP.%CNT1%.%CNT2%=ENEMY.HOLO.HP.%CNT1%.%CNT2%/100"
EXIT /B 0

:RAND
SET /A "ENEMY.HP.NOW.%1=%random% %% %2 %3"
EXIT /B 0