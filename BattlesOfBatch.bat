::Created by 136MasterNR - Read the "copyright.txt" file for more info.
::(Use "NotePadPP" or anything other than "Notepad" to view better this file)
:: Languages used:    99.4% Batch    0.6% VBScript
::______ ______ ______ ______ ______ ______ ______ ______ ______
::_____//_____//_____//_____//_____//_____//_____//_____//______\\
::    _____        __           _____ _             _ _         | |
::   |  __ \      / _|         / ____| |           | |_)        | |
::   | |__) |__ _| |_ _   _   | (___ | |_ _   _  __| |_  ___    | |
::   |  _  // _` |  _| | | |   \___ \| __| | | |/ _` | |/ _ \   | |
::   | | \ \ (_| | | | |_| |   ____) | |_| |_| | (_| | | (_) |  | |
::   |_|  \_\__,_|_|  \__,_|  |_____/ \__|\__,_|\__,_|_|\___/   | |
::______ ______ ______ ______ ______ ______ ______ ______ ______| |
::_____//_____//_____//_____//_____//_____//_____//_____//______//
::
::                                                           !!!! WARNING !!!!                                                         ::
:: - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ::
::                                                                                                                                     ::
:: (!) DO NOT EDIT THIS FILE UNLESS YOU KNOW WHAT YOU ARE DOING - EDITING ANYTHING IN HERE MAY CAUSE MISS BEHAVIOR AND CAUSE PROBLEMS  ::
::     TO YOUR COMPUTER (!)                                                                                                            ::
:: (!) IF ANYONE TOLD YOU TO COPY AND PASTE CODE IN HERE OR DOWNLOAD ADDITIONAL FILES, THEY ARE MOST LIKELY TRYING TO SCAM YOU,        ::
::     UNLESS YOU ARE A TESTER AND THE OFFICIAL DEVELOPERS TOLD YOU TO DO SO (!)                                                       ::
::                                                                                                                                     ::
:: - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ::
::                                                                                                                                     ::
:LAUNCHER
@PUSHD "%~dp0"
@TITLE Battles of Batch
@CHCP 65001 >NUL
@PROMPT !^>
@VERIFY OFF
@ECHO OFF
ECHO.[?25l Preparing ...
FOR /F "TOKENS=4-5 DELIMS= " %%I IN ('VER') DO SET WINVER=%%I
IF NOT "=%WINVER:~0,3%" == "=10." (
	CLS
	ECHO.You are NOT running a supported OS or OS Version. Upgrade/Change your OS to Windows 10 or 11!
	PAUSE>NUL
	EXIT
)
:: Check if logs folder exist,
IF NOT EXIST ".\data\logs" MD ".\data\logs"
::  start the logger and check if accessible,
2>>".\data\logs\errors.txt" ( SET "STARTED=1"&CALL :STARTUP-COMPLETE )
::   if not accessible then exit, else below command will be skipped.
IF DEFINED RUNNING (
	CALL :ERROR ERRLINE IDUNKNOWN    0
	EXIT 1
) ELSE @IF /I NOT DEFINED STARTED EXIT 1
:STARTUP-COMPLETE
SET RUNNING=TRUE
IF NOT EXIST "%~n0%~x0" (
	CLS
	ECHO.ERR : Inaccessible Directory.
	ECHO.
	ECHO.Try the following:
	ECHO.1. Don't run the batch file within a zip file or any winrar format.
	ECHO.2. Make sure that the batch file has permissions to Read/Write in this directory.
	ECHO.3. Don't launch the batch file directly from a search bar or a run-in.
	ECHO.4. If you are using a shortcut, make sure you added the correct directory.
	ECHO.5. Do not run with administrator/elevated permissions.
	ECHO.
	ECHO.If none of the above helped, contact us.
	PAUSE>NUL
	EXIT /B
) ELSE IF NOT EXIST "%CD%" (
	CLS
	ECHO.ERR : Unreachable Directory.
	ECHO.
	ECHO.Try the following:
	ECHO.1. Move the game ^(the whole folder^) to a different location.
	ECHO.2. Make sure the directory's URL name includes ONLY latin characters.
	ECHO.3. Do not move it to shared folders or onedrive.
	ECHO.
	ECHO.If none of the above helped, contact us.
	PAUSE>NUL&EXIT
)
:RESTART
COLOR 0F
::VAR:-Variables
SET "DM=%CD%"
SET "DATA=%CD%\data"
SET "DATA_TMP=%DATA%\temp"
SET "DATA_IMAGES=%DATA%\images"
SET "DATA_SCRIPTS=%DATA%\scripts"
CALL "%DATA_SCRIPTS%\versions.cmd" || CALL :ERROR ERRLINE ID0001    0
:: Detect Errors
IF NOT DEFINED VERCODE CALL :ERROR ERRLINE ID0001A    0
IF NOT DEFINED VERS CALL :ERROR ERRLINE ID0001B    0
IF NOT DEFINED VERTYPE CALL :ERROR ERRLINE ID0001C    0
IF NOT DEFINED VERCOD.AUDIO_MANAGER CALL :ERROR ERRLINE ID0001D    0
IF NOT EXIST "%DATA_TMP%" MD "%DATA_TMP%"
SET "HTS_DATA=%APPDATA%\HTS_DATA"
SET "MAIN_GAME=%HTS_DATA%\BATTLESOFBATCH-%VERTYPE%-%VERCODE%"
SET "DATA_SAVES=%MAIN_GAME%\SAVES"
SET "DATA_SETTINGS=%MAIN_GAME%\SETTINGS"
SET "HTSANI=%DATA_SCRIPTS%\htsani.cmd"
SET "WAIT=%DATA_SCRIPTS%\wait.vbs"
SET "TITLE=Battles of Batch - "
SET "COPYRIGHT=copyright.txt"
SET "LICENSE=license.txt"
SET "PLAYERDATA.MONEY=%DATA_SCRIPTS%\playerdata\money.cmd"
SET "PLAYERDATA.XP=%DATA_SCRIPTS%\playerdata\xp.cmd"
SET "PLAYERDATA.LVL=%DATA_SCRIPTS%\playerdata\lvl.cmd"
SET "PLAYERDATA.LOAD=%DATA_SAVES%\PLAYERDATA.cmd"
SET "DATA_SAVES.INV=%DATA_SAVES%\inv"
SET "PLAYERSKILLS.LOAD=%DATA_SAVES%\SKILLS.cmd"
SET "SYS_LVL=%DATA_SCRIPTS%\playerdata\sys_lvl"
SET "UPDATER=%DATA_SCRIPTS%\updater.cmd"
SET "SAVE=%DATA_SCRIPTS%\save.cmd"
SET "ITEMS.LOADER=%DATA_SCRIPTS%\playerdata\items.cmd"
SET "ENEMY=%DATA_SCRIPTS%\game\enemy.cmd"
SET "EVENT=%DATA_SCRIPTS%\game\event.cmd"
SET "DEBUG.GAMELOADER=%DATA_SCRIPTS%\debug"
SET SHOP.TAB=2
SET "SCRIPTS_POP=%DATA_SCRIPTS%\pop"
SET "DEV_ERR=%SCRIPTS_POP%\deverr.cmd"
SET "CHOICE=CALL ^"%DATA_SCRIPTS%\choice.bat^""
SET "INPUT_PART=nul"
::VAR:-Settings
SET "SETTINGS.LOAD=%DATA_SETTINGS%\settings.cmd"
SET "SETTING=%DATA_SCRIPTS%\settings.cmd"
SET "IGNORE_ERRORS=FALSE"
::VAR:-Shortcut
SET "TARGET=BattlesOfBatch"
::VAR:-Cleanup
SET OLD.PLAYER.LVL=
SET HTS_DIR_ERR=
SET UDERFINE=
SET RAINBOWMODE=
::VAR:-Player Stats
SET PLAYER.XP=0
SET PLAYER.XP.REQ=45
SET PLAYER.LVL=0
SET PLAYER.MAP.LEVEL=1
SET PLAYER.MONEY=0
SET CRIT.RATE=4
SET CRIT.STRE=60
SET "SEL.CHARACTER=SIMPSONS"
::VAR:-Shop
SET SHOP.PRICE.HEAL=10
SET SHOP.MAX.HEAL=400
SET SHOP.LVLREQ.HEAL=1
SET SHOP.PRICE.BOMB=100
SET SHOP.LVLREQ.BOMB=4
SET SHOP.MAX.BOMB=250
SET "SHOP.HEAL=%DATA_SCRIPTS%\shop\heal.cmd"
SET "SHOP.BOMB=%DATA_SCRIPTS%\shop\bomb.cmd"
::VAR:-Skills
SET "SKILL.UPGRADE=%DATA_SCRIPTS%\playerdata\upgrade.cmd"
SET SKILL.ATK.MAXLVL=2
SET SKILL.ATK.COST=460
SET SKILL.CRIT_RATE.MAXLVL=4
SET SKILL.CRIT_RATE.COST=1250
SET SKILL.HP.MAXLVL=5
SET SKILL.HP.COST=8200
::VAR:-Audio
SET /A VOLUME.BATTLE=100*VOLUME/100*50
SET /A VOLUME.BATTLE=%VOLUME%-%VOLUME.BATTLE%/100
SET "DATA_AUD=%DATA%\audio"
SET "DATA_AUD_S=%DATA_AUD%\system"
SET "DATA_AUDIO_G=%DATA_AUD%\game"
SET "DATA_AUDIO_G_P=%DATA_AUDIO_G%\player"
SET "DATA_AUDIO_G_B=%DATA_AUDIO_G%\battle"
SET "DATA_AUDIO_G_P_SUB=%DATA_AUDIO_G_P%\substat"
SET "DATA_AUDIO_G_P_ATK=%DATA_AUDIO_G_P%\attack"
SET "SFX.ATK=%DATA_AUDIO_G_P_ATK%\swing_"
SET "SFX.ATK.CRIT=%DATA_AUDIO_G_P_ATK%\crit_"
SET "SFX.ATK.MISS=%DATA_AUDIO_G_P_ATK%\miss_"
SET "SFX.BOMB=%DATA_AUDIO_G_P_SUB%\bomb"
SET "SFX.LASER=%DATA_AUDIO_G_P_SUB%\laser"
SET "DATA_AUDIO_SYS=%CD%\data\audio\sys"
SET "DATA_AUDIO_SYS_MENU=%CD%\data\audio\sys\menu"
SET "DATA_TMP_A=%DATA_TMP%\TMP_AUDIO.vbs"
SET "AudioManager=%DATA_SCRIPTS%\AudioManager.bat"
SET "ADirector=wscript.exe"
SET "AUD.MENU=%DATA_AUD_S%\menu.mp3"
SET "AUD.BATTLE.NORMAL=%DATA_AUDIO_G_B%\battle_normal.mp3"
SET "AUD.BATTLE.BOSS=%DATA_AUDIO_G_B%\battle_bossfight.mp3"
SET "MENU.AUDIO=%DATA_SCRIPTS%\menuaudio.cmd"
::VAR:-Layout
SET COLS=117
SET LINES=48
::VAR:-Interface
SET "INTERFACE=%DATA_SCRIPTS%\interface"
SET "STAT.MONEY=%INTERFACE%\money.cmd"
SET "STAT.XP=%INTERFACE%\xp.cmd"
SET "STAT.MAP=%INTERFACE%\map.cmd"
SET "STAT.LVL=%INTERFACE%\lvl.cmd"
SET "STAT.CMAPS=%INTERFACE%\cmaps.cmd"
SET "INT.TITLE=%INTERFACE%\title.cmd"
SET "INT.TITLE_R=%INTERFACE%\title_r.cmd"
SET "INT.TITLE_U=%INTERFACE%\title_u.cmd"
SET "IG.CMDS=%INTERFACE%\ingame\commands.cmd"
SET "UI.ITEMS=%INTERFACE%\shop\items.cmd"
SET "UI.SKILLS=%INTERFACE%\shop\skills.cmd"
SET "UI.CRAFT=%INTERFACE%\shop\craft.cmd"
SET "CENTER=%INTERFACE%\center.cmd"
SET "CHARACTER=%INTERFACE%\characters.cmd"
::VAR:-Inventory
SET "PLAYERDATA.ITEMS=%DATA_SAVES.INV%\ITEMS"
SET "PLAYERDATA.EQ=%DATA_SAVES.INV%\EQUIP"
SET "PLAYERDATA.MATERIALS=%DATA_SAVES.INV%\MATERIALS"
SET "PLAYERDATA.WEAPONS=%DATA_SAVES.INV%\WEAPONS"
SET INV_CHOICE=1
SET INV_CHOICE_SLOT=1
SET W_INV_CHOICE=1
::VAR:-Craft
SET "CRAFT.MNGR=%DATA_SCRIPTS%\craft.cmd"
SET "CRAFT.INFO=%INTERFACE%\shop\craft_info.cmd"
SET CRAFT.SEL=0
SET CRAFT.NAV=0
::VAR:-Regit
SET "REGIT_1=HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{22d6f312-b0f6-11d0-94ab-0080c74c7e95}"
SET "REGIT_2=HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{6BF52A52-394A-11d3-B153-00C04F79FAA6}"
SET REGID_C1=
SET REGID_C2=
::VAR:-Battle Loader
SET "SCRIPTS_GAME=%DATA_SCRIPTS%\game"
SET "LOAD.LEVEL_=%DATA%\levels\lvl"
SET "LOC.HP.P=[11;4H"
::VAR:-Action
SET "SCRIPTS_ACT=%SCRIPTS_GAME%\acts"
SET "ACT.ATTACK=%SCRIPTS_ACT%\ATTACK.cmd"
SET "ACT.BOMB=%SCRIPTS_ACT%\BOMB.cmd"
SET "ACT.HEAL=%SCRIPTS_ACT%\HEAL.cmd"
SET "ACT.ENEMY_ATK=%SCRIPTS_ACT%\ENEMY_ATK.cmd"
SET "ACT.SIMPSONS.LASER=%SCRIPTS_ACT%\LASER.cmd"
SET "CMD.CLEARVAR=%SCRIPTS_GAME%\CLEARVAR.cmd"
::VAR:-Map
SET SELECTED=0
SET CHAPTER=1
SET "MAP.LOAD=%INTERFACE%\map"
::VAR:-ANSI Coloring
SET "RGB=[38;2;"
SET "RGB.COIN=%RGB%252;255;166m"
SET "RGB.LVL=%RGB%128;200;255m"
SET "RGB.TRUE=%RGB%163;255;177m"
SET "RGB.FALSE=%RGB%255;89;89m"
SET "RGB.CYAN=%RGB%133;222;255m"
SET "RGB.YELLOW=%RGB%255;252;176m"
SET "RGB.ORANGE=%RGB%255;176;79m"
SET "RGB.RED=%RGB%255;61;51m"
SET "RGB.GREEN=%RGB%102;255;0m"
SET "RGB.DGRAY=%RGB%169;169;169m"
::VAR:-Quests
SET "QUEST.LOADER=%DATA_SCRIPTS%\quests.cmd"
SET "QNAME.TOTAL_MONSTERS=Sereal Killer"
SET QREW.MONEY.TOTAL_MONSTERS=12500
SET QREW.XP.TOTAL_MONSTERS=30000
SET QMAX.TOTAL_MONSTERS=250
SET "QDESC.TOTAL_MONSTERS=[1;37mKill a total of [4m%QMAX.TOTAL_MONSTERS%[0m[1;37m monsters."
SET "QNAME.MTYPE=All The Species"
SET QMAX.MTYPE=29
SET "QDESC.MTYPE=[1;37mKill every single type of monster."
SET "QNAME.LOSE=For God's Sake"
SET QREW.MONEY.LOSE=2000
SET QREW.XP.LOSE=500
SET QMAX.LOSE=5
SET "QDESC.LOSE=[1;37mLose the battle [4m%QMAX.LOSE%[0m[1;37m times."
SET "QNAME.TLVLS=The Champ"
SET QREW.MONEY.TLVLS=20000
SET QREW.XP.TLVLS=120000
SET QMAX.TLVLS=120
SET "QDESC.TLVLS=[1;37mWin [4m%QMAX.TLVLS%[0m[1;37m battles."
::VAR:-END

MODE CON:COLS=%COLS% LINES=%LINES%
ECHO.[?25l[s Loading ...
IF NOT EXIST "%HTS_DATA%" MD "%HTS_DATA%"
IF NOT EXIST "%HTS_DATA%" (
	ECHO.Failed to create directory "HTS_DATA" on "%APPDATA%".
	ECHO.Quitting ...
	PAUSE>NUL
	EXIT /B 1
)
IF NOT EXIST "%MAIN_GAME%" MD "%MAIN_GAME%"
IF NOT EXIST "%DATA_SAVES%" MD "%DATA_SAVES%"
IF NOT EXIST "%DATA_SETTINGS%" MD "%DATA_SETTINGS%"
IF NOT EXIST "%DATA_SAVES.INV%" MD "%DATA_SAVES.INV%"

REG Query "HKLM\Hardware\Description\System\CentralProcessor\0" | FIND /i "x86" > NUL && SET OSBIT=32 || SET OSBIT=64
IF NOT EXIST "%MAIN_GAME%\32.dll" (
	IF %OSBIT%==32 (
		CLS
		ECHO WARNING!
		ECHO.Your device does not support 64-bit units.
		ECHO.We higly recommend you to upgrade!
		ECHO.
		ECHO.Due to this, you may be dealing with various unexpected
		ECHO.issues while using this product.
		ECHO.
		ECHO.Press any key to continue or just exit.
		PAUSE>NUL
	)
	ECHO.[IGNORE]>"%MAIN_GAME%\32.dll"
)

IF NOT EXIST "%MAIN_GAME%\LICENSEAGREEMENT.dll" IF EXIST "%LICENSE%" (
	IF EXIST "%COPYRIGHT%" (
		CLS
		ECHO.Please read and confirm that you agree to our License!
		ECHO.By closing the License text window you agree, and be
		ECHO.able to continue using this product.
		START /WAIT "" "%COPYRIGHT%"
		ECHO.[AGREE]>"%MAIN_GAME%\LICENSEAGREEMENT.dll"
		CLS
	)
) ELSE (
	CLS
	ECHO.No ACCEPTED license was found within this product.
	ECHO.Using a product without a lisence is legally disallowed by the Copyright Laws.
	ECHO.
	ECHO.Please consider reinstalling this product.
	ECHO.If this solution does not help, please contact us to find a solution.
	PAUSE>NUL
	EXIT 0
)

:SYSLOAD
ECHO.[u Loading ... (System)  
::System: Input 
SET INPUT=^
FOR %%. IN (1 2) DO IF %%.==2 (^
FOR /F "DELIMS=" %%I IN ('.\data\scripts\input.bat !ARGS!') DO ^
	SET "UDERFINE=%%I"^
) ELSE SET ARGS=
::System: Super Characters
FOR /F %%A IN ('COPY /Z "%COMSPEC%" NUL') DO SET "CR=%%A"
FOR /F %%A IN ('"PROMPT $H$E&FOR %%B IN (1) DO REM"') DO SET "BS=%%A"    
::Shortcut
IF EXIST "Battles of Batch.lnk" GOTO SETT-MAKE
SET SCSCRIPT="%TEMP%\%RANDOM%-%RANDOM%-%RANDOM%-%RANDOM%.vbs"
(
	ECHO Set oWS = WScript.CreateObject^("WScript.Shell"^)
	ECHO sLinkFile = "%cd%\Battles of Batch.lnk"
	ECHO Set oLink = oWS.CreateShortcut^(sLinkFile^)
	ECHO oLink.TargetPath = "%cd%\%TARGET%"
	ECHO oLink.WorkingDirectory = "%cd%"
	ECHO oLink.IconLocation = "%DATA_IMAGES%\icon_256.ico"
	ECHO oLink.Save
) > %SCSCRIPT%
CSCRIPT /nologo %SCSCRIPT% || CALL :ERROR ERRLINE ID0003    -0
DEL %SCSCRIPT%
ECHO.[u Loading ... (Settings)
::SETTINGSREADER
:SETT-MAKE
IF NOT EXIST "%DATA_SETTINGS%\settings.cmd" (
	(
		ECHO.SET AUDIO.VALUE=TRUE
		ECHO.SET VOLUME=90
		ECHO.SET SFX.VOLUME=90
		ECHO.SET AUTOSAVE.VALUE=TRUE
		ECHO.SET UPDATE.VALUE=TRUE
		ECHO.SET SHORTCUTS.VALUE=TRUE
		ECHO.SET SHOW.INTRO=TRUE
		ECHO.GOTO :EOF
	)>%SETTINGS.LOAD%
)
CALL %SETTINGS.LOAD%
IF NOT DEFINED AUDIO.VALUE CALL :SETT_ERR
IF NOT DEFINED VOLUME CALL :SETT_ERR
IF NOT DEFINED SFX.VOLUME CALL :SETT_ERR
IF NOT DEFINED AUTOSAVE.VALUE CALL :SETT_ERR
IF NOT DEFINED UPDATE.VALUE CALL :SETT_ERR
IF NOT DEFINED SHORTCUTS.VALUE CALL :SETT_ERR
IF NOT DEFINED SHOW.INTRO CALL :SETT_ERR
REG QUERY "%REGIT_1%" > NUL
IF ERRORLEVEL 1 SET REGID_C1=TRUE
REG QUERY "%REGIT_2%" > NUL
IF ERRORLEVEL 1 SET REGID_C2=TRUE

IF DEFINED REGID_C1 (
	IF DEFINED REGID_C2 (
		IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 CALL "%TOGGLE.SOUNDS%"
		SET DENIED_AUDIO=TRUE
		CALL "%SETTINGS.LOAD%"
	)
)
ECHO.[u Loading ... (Updates)    
IF "%UPDATE.VALUE%"=="TRUE" (
	CALL "%UPDATER%" 2>NUL
	CLS
)
ECHO.[u Loading ... (PlayerData)    
::FOR %%I IN ("%DATA_SETTINGS%\*") DO CALL "%%I"

::SAVESREADER
>NUL 2>NUL DIR /A-D "%DATA_SAVES%\*.cmd" && (CALL "%DATA_SAVES%\PLAYERDATA.cmd")||((
		ECHO.SET PLAYER.MONEY=0
		ECHO.SET PLAYER.XP=0
		ECHO.SET PLAYER.LVL=0
		ECHO.SET PLAYER.MAP.LEVEL=1
		ECHO.SET PLAYER.XP.REQ=%PLAYER.XP.REQ%
		ECHO.SET COMPLETED.MAPS=0
		ECHO.GOTO :EOF
	)>"%DATA_SAVES%\PLAYERDATA.cmd"
	CALL "%DATA_SAVES%\PLAYERDATA.cmd"
)

IF NOT EXIST "%PLAYERDATA.ITEMS%" COPY NUL "%PLAYERDATA.ITEMS%" >NUL
IF NOT EXIST "%PLAYERDATA.WEAPONS%" COPY NUL "%PLAYERDATA.WEAPONS%" >NUL
IF NOT EXIST "%PLAYERDATA.MATERIALS%" COPY NUL "%PLAYERDATA.MATERIALS%" >NUL
IF EXIST "%PLAYERDATA.EQ%" FOR /F %%I IN ("%PLAYERDATA.EQ%") DO IF %%~ZI==0 DEL "%PLAYERDATA.EQ%"
IF NOT EXIST "%PLAYERDATA.EQ%" (
	ECHO.EMPTY>"%PLAYERDATA.EQ%"
	ECHO.EMPTY>>"%PLAYERDATA.EQ%"
	ECHO.EMPTY>>"%PLAYERDATA.EQ%"
	ECHO.EMPTY>>"%PLAYERDATA.EQ%"
)
>NUL 2>NUL DIR /A-D "%DATA_SAVES%\*.cmd" && CALL "%DATA_SAVES%\QUESTS.cmd"||((
		ECHO.SET Q.TOTAL_MONSTERS=0
		ECHO.SET Q.MONSTER_TYPE=0
		ECHO.SET Q.LOSE=0
		ECHO.GOTO :EOF
	)>"%DATA_SAVES%\QUESTS.cmd"
	CALL "%DATA_SAVES%\QUESTS.cmd"
)
>NUL 2>NUL DIR /A-D "%DATA_SAVES%\*.cmd" && CALL "%PLAYERSKILLS.LOAD%"||((
		ECHO.SET SKILL.ATK=1
		ECHO.SET SKILL.CRIT_RATE=1
		ECHO.SET SKILL.HP=1
		ECHO.GOTO :EOF
	)>"%PLAYERSKILLS.LOAD%"
	CALL "%PLAYERSKILLS.LOAD%"
)
ECHO.[u Loading ... (RegisterItem)
CALL "%ITEMS.LOADER%" REGISTER
CALL "%ITEMS.LOADER%" LIST
CALL "%ITEMS.LOADER%" LIST_EQ
CALL "%ITEMS.LOADER%" WEAPONS
SET /A "SELECTED=%PLAYER.MAP.LEVEL%"
IF %SELECTED% GTR 13 SET SELECTED=1
CALL "%DATA_SCRIPTS%\mapnames.cmd"
::Audio Manager
IF NOT DEFINED AUDIO.VALUE CALL :SETT_ERR
IF NOT DEFINED VOLUME CALL :SETT_ERR
IF %AUDIO.VALUE%==TRUE ( TASKKILL /F /FI "WINDOWTITLE eq wscript.exe" /T>NUL&START /MIN "" "%AudioManager%" || CALL :ERROR ERRLINE ID0004    -0 )
MODE CON:COLS=%COLS% LINES=%LINES%
ECHO. Loading ... (Display)
::PAUSE>NUL
::CALL ".\data\levels\lvl1\story.cmd"
CALL "%DATA_SAVES%\PLAYERDATA.cmd" || CALL :ERROR ERRLINE ID0005    -0
CALL "%SYS_LVL%" || CALL :ERROR ERRLINE ID0006    -0
SET OLD.PLAYER.LVL=%PLAYER.LVL%
IF %SHOW.INTRO%==TRUE (
	TITLE %TITLE%HTS
	CALL "%HTSANI%" || CALL :ERROR ERRLINE ID0007    -0
	CSCRIPT "%WAIT%" 750 >NUL || CALL :ERROR ERRLINE ID0008    -0
)
:MENU
@CHCP 65001>NUL
CALL "%MENU.AUDIO%"
CLS
:S-MENU
TITLE %TITLE%Menu
:REFRESH-MENU
CALL "%PLAYERDATA.LOAD%"
CALL "%SYS_LVL%"
SET PLAYER.MONEY.INTF=
SET PLAYER_MONEY_IF_4=%PLAYER.MONEY:~3,1%
IF NOT %PLAYER.MONEY:~9%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY%
) ELSE IF NOT %PLAYER.MONEY:~8,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,3%,%PLAYER.MONEY:~3,3%,%PLAYER.MONEY:~6%
) ELSE IF NOT %PLAYER.MONEY:~7,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,2%,%PLAYER.MONEY:~2,3%,%PLAYER.MONEY:~5%
) ELSE IF NOT %PLAYER.MONEY:~6,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,1%,%PLAYER.MONEY:~1,3%,%PLAYER.MONEY:~4%
) ELSE IF NOT %PLAYER.MONEY:~5,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,3%,%PLAYER.MONEY:~3,3%
) ELSE IF NOT %PLAYER.MONEY:~4,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,2%,%PLAYER.MONEY:~2,3%
) ELSE IF NOT %PLAYER.MONEY:~3,1%.==. ( SET PLAYER.MONEY.INTF=%PLAYER.MONEY:~0,1%,%PLAYER.MONEY:~1,3%
) ELSE SET PLAYER.MONEY.INTF=%PLAYER.MONEY%
IF %PLAYER.LVL% LSS 60 ( SET "CRTLVL=%PLAYER.LVL%" ) ELSE (SET "CRTLVL=%PLAYER.LVL% ^(MAX!^)")
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=%RGB.GREEN%Money[0m: [1m%PLAYER.MONEY.INTF% %RGB.GREEN%$[0m"
CALL "%CENTER%" 99
ENDLOCAL&SET "UI.MENU.MO=%STR%"
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=%RGB.LVL%Level[0m:[1m ↑%CRTLVL% %RGB.DGRAY%([0mXP%RGB.DGRAY%: [0m%PLAYER.XP%%RGB.DGRAY%/[0m%PLAYER.XP.REQ%%RGB.DGRAY%^)[0m"
CALL "%CENTER%" 173
ENDLOCAL&SET "UI.MENU.XP=%STR%"
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=%RGB.RED%Next Battle[0m: [1m!MAP.NAME.%PLAYER.MAP.LEVEL%:_= ! %RGB.DGRAY%([0mTotal Wins%RGB.DGRAY%: [0m%COMPLETED.MAPS%%RGB.DGRAY%^^)[0m"
CALL "%CENTER%" 148
ENDLOCAL&SET "UI.MENU.MA=%STR%"
IF 0==0 (
ECHO.[0m[H[?25l.-------------------------------------------------------------------------------------------------------------------.
IF "%RAINBOWMODE%"=="TRUE" ( CALL "%INT.TITLE_R%" ) ELSE ( CALL "%INT.TITLE%" )
ECHO.'-.--------[1;30m.[0m--[1;30m.[0m------------.                                                             .------------------------.-'[E.-'--------[1;30m^|[0m--[1;30m^|[0m------------'                    .---.-----------.---.                    '------------------------'-.
ECHO.^|          [1;30m^|  ^|[0m             .------------------'    :   [1;34mSTATS[0m   :    '------------------.                           ^|
ECHO.^|          [1;30m^|  ^|[0m             \                       '-----------'                       /        _   ,_,   _        ^|
ECHO.^|  \_      [1;30m^|  ^|[0m      _/     /   %UI.MENU.XP%  \       / `'=^) ^(='` \       ^|
ECHO.^|   ]'--___[1;30m^|[0m__[1;30m^|[0m___--'[      \   %UI.MENU.MO%  /      /.-.-.\ /.-.-.\      ^|
ECHO.^|   ^|       ^|^|       ^|      /   %UI.MENU.MA%  \      `      ^"      `      ^|
ECHO.^|   \       ^|^|       /      \             .--------------------------------.            /                           ^|
ECHO.^|    [      ^|^|      ]        '-----------'                                  '----------'                            ^|
ECHO.^|    ^|______^(^)______^|                                  [1;37mWelcome![0m                                                     ^|
ECHO.^|    ^|----^(^(^<^>^)^)----^|                                                                                               ^|
ECHO.^|    ]      ^(^)      [                                                                                               ^|
ECHO.^|     \     ^|^|     /                              .--.----------.--.                                                ^|
ECHO.^|      [    ^|^|    ]                   .----------'   : [1;34mCOMMANDS[0m :   '----------.                                    ^|
ECHO.^|      \    ^|^|    /             [1m,-,_[0m  ^|              '----------'              ^|                                    ^|
ECHO.^|       [   ^|^|   ]              [1m^|  _T[0m ^| [s        - [1;37mSelect a level.[0m              ^|                                    ^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[uPress %RGB.CYAN%A[0m ) ELSE ( ECHO.[u%RGB%128;210;255m   PLAY[0m)
ECHO.^|        \__^|^|__/               [1m'-`^|^|[0m ^| - - - - - - - - - - - - - - - - - - -  ^|                          ,_,       ^|
ECHO.^|           --                    :[1m^|^|[0m-^| [s        - [1;37mView your quests.[0m            ^|                         ^(.,.^)      ^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[uPress %RGB%138;167;255mQ[0m ) ELSE ( ECHO.[u%RGB%138;167;255m QUESTS[0m)
ECHO.^|                                 :[1m^|^|[0m-^| - - - - - - - - - - - - - - - - - - -  ^|                         ^(   ^)      ^|
ECHO.^|                                  [1m[][0m ^| [s        - [1;37mBuy items ^& skills.[0m          ^|                         -"-"-------^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[uPress %RGB%105;255;147mW[0m ) ELSE ( ECHO.[u%RGB%105;255;147m   SHOP[0m)
ECHO.^|                                     ^| - - - - - - - - - - - - - - - - - - -  ^|                                    ^|
ECHO.^|                                     ^| [s        - [1;37mManage your character.[0m       ^|                                    ^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[uPress %RGB%191;255;221mE[0m ) ELSE ( ECHO.[u%RGB%191;255;221m    INV[0m)
ECHO.^|                                     ^| - - - - - - - - - - - - - - - - - - -  ^|                                    ^|
ECHO.^|               [1m/\_[]_/\[0m              ^| [s        - [1;37mChange your preferences.[0m     ^|                                    ^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[uPress %RGB%249;241;165mS[0m ) ELSE ( ECHO.[u%RGB%249;241;165mOPTIONS[0m)
ECHO.^|              [1m^|] _^|^|_ [^|[0m             ^| - - - - - - - - - - - - - - - - - - -  ^|                                    ^|
ECHO.^|       ___     [1m\/ ^|^| \/[0m              '.      [s                                .'                                    ^|
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[u       Press a Key[0m) ELSE ( ECHO.[u[1;30mMore: Credits,Cheats,CMD[0m)
ECHO.^|      /\ /\       [1m^|^|[0m                  '--------------------------------------'                                     ^|
ECHO.^|     ^(^|0 0^|^)      [1m^|^|[0m                                                                                               ^|
ECHO.^|   __/{\^^/}\_ ____/^>                                .    '    .                                                    ^|
ECHO.^|  / \  {~}   / _^|_P/                                  _______                                                      ^|
ECHO.^|  ^| /\  ~   /_/   [1m[][0m                             _  .`_^|___^|_`.  _                                                 ^|
ECHO.^|  ^|_^| ^(____^)                                         \ \   / /                             ___                     ^|
ECHO.^|  \_]/______\                                         \ ' ' /                           __/_  `.  .-^"^"^"-. .        ^|
ECHO.^|     _\_^|^|_/_                                          \ ^" /                            \_,` ^| \-'  /   ^)`-'       ^|
ECHO.^|    ^(_,_^|^|_,_^)                                          \./                              ___Y  ,    .'7 /^|         ^|
ECHO.^|                                                         V                              ^(_,___/...-` ^(_/_/         ^|[E^| [1;30m2023©136MasterNR[0m                                                                   [1;30mBATTLES OF BATCH: [0;33m%VERTYPE% %VERS%[0m ^|[?25h
)
IF "%SHORTCUTS.VALUE%"=="TRUE" ( 
	ECHO.^|     .                              .    .                              .    .                              .      ^|[E^|     ^|       ^|       .       ^|      ^|    ^|       ^|       .       ^|      ^|    ^|       ^|       .       ^|      ^|      ^|[E'-----'-------'-------'-------'------'----'-------'-------'-------'------'----'-------'-------'-------'------'------'[2A
) ELSE (
	ECHO..-------------------------------------------------------------------------------------------------------------------.
	ECHO.^|                                                                                                                   ^|
	ECHO.'-------------------------------------------------------------------------------------------------------------------'[2A
)
IF NOT %OLD.PLAYER.LVL%==%PLAYER.LVL% (
	CALL "%SCRIPTS_POP%\lvlup.cmd"
	GOTO REFRESH-MENU
)
CALL "%QUEST.LOADER%" LOAD
IF DEFINED Q.POPUP.IS SET "Q.POPUP.IS="&GOTO MENU
SET UDERFINE=
:MENU-INPUT
IF "%SHORTCUTS.VALUE%"=="TRUE" (
	GOTO :CHOICE-INPUTS
)
SET "INPUT_PART=menu"
SETLOCAL ENABLEDELAYEDEXPANSION
IF EXIST LET.DEBUG ( SET /P "UDERFINE=| Type: [s[30;1mDEBUG MODE ENABLED![1;37m[18D" ) ELSE %INPUT% "PROMPT=[0m| [0;36mType[0m: [1;37m[s" "LENGTH=107"
ENDLOCAL&SET UDERFINE=%UDERFINE%
ENDLOCAL
SET "INPUT_PART=nul"
 IF NOT DEFINED UDERFINE ECHO.[2A&GOTO MENU-INPUT
	IF /I "%UDERFINE%"=="SHOP" GOTO SHOP
	 IF /I "%UDERFINE%"=="BUY" GOTO SHOP
      IF /I "%UDERFINE%"=="SKILLS" (
  	    SET "SHOP.TAB=2"
  	    GOTO SHOP
      )
      IF /I "%UDERFINE%"=="ITEMS" (
  	    SET "SHOP.TAB=1"
	    GOTO SHOP
      )
	IF /I "%UDERFINE%"=="MAP" GOTO MAP
	 IF /I "%UDERFINE%"=="MAPS" GOTO MAP
	  IF /I "%UDERFINE%"=="LEVEL" GOTO MAP
	   IF /I "%UDERFINE%"=="LEVELS" GOTO MAP
	IF /I "%UDERFINE%"=="SET" GOTO SETTINGS
	 IF /I "%UDERFINE%"=="SETTINGS" GOTO SETTINGS
	  IF /I "%UDERFINE%"=="SETTING" GOTO SETTINGS
	   IF /I "%UDERFINE%"=="OPTIONS" GOTO SETTINGS
		IF /I "%UDERFINE%"=="OPTION" GOTO SETTINGS
		 IF /I "%UDERFINE%"=="PREFERENCES" GOTO SETTINGS
		  IF /I "%UDERFINE%"=="PREFERENCE" GOTO SETTINGS
	IF /I "%UDERFINE%"=="START" GOTO MAP
	 IF /I "%UDERFINE%"=="PLAY" GOTO MAP
	  IF /I "%UDERFINE%"=="FIGHT" GOTO MAP
	   IF /I "%UDERFINE%"=="BATTLE" GOTO MAP
	    IF /I "%UDERFINE%"=="START GAME" GOTO MAP
	IF /I "%UDERFINE%"=="QUESTS" GOTO QUESTS
	 IF /I "%UDERFINE%"=="QUEST" GOTO QUESTS
	IF /I "%UDERFINE%"=="INV" GOTO INVENTORY
	 IF /I "%UDERFINE%"=="INVENTORY" GOTO INVENTORY
	IF /I "%UDERFINE%"=="CHARACTER" GOTO CHARACTER
	 IF /I "%UDERFINE%"=="CHAR" GOTO CHARACTER
	IF /I "%UDERFINE%"=="LICENSE" GOTO LICENSE
	IF /I "%UDERFINE%"=="CREDITS" GOTO CREDITS
	 IF /I "%UDERFINE%"=="CREDIT" GOTO CREDITS
	IF /I "%UDERFINE%"=="UPDATE" CALL "%UPDATER%" MANUAL&GOTO MENU
	IF /I "%UDERFINE%"=="EXIT" EXIT
	 IF /I "%UDERFINE%"=="QUIT" EXIT
	IF /I "%UDERFINE%"=="DEV" GOTO DEV
	 IF /I "%UDERFINE%"=="CHEATS" ECHO.THIS IS DISABLED&PAUSE>NUL
	  IF /I "%UDERFINE%"=="CMD" GOTO TERMINAL
	IF /I "%UDERFINE%"=="RESET" GOTO RESET
	IF /I "%UDERFINE%"=="RESTART" GOTO RESTART
	IF /I "%UDERFINE%"=="APPDATA" START "" "%MAIN_GAME%"

	IF /I "%UDERFINE:~0,2%"=="RE" ( 
		MODE CON:COLS=%COLS% LINES=%LINES%
		GOTO MENU
	)
	IF /I "%UDERFINE%"=="HTS" (
		IF "%RAINBOWMODE%"=="TRUE" ( SET "RAINBOWMODE=" ) ELSE SET "RAINBOWMODE=TRUE"
		GOTO REFRESH-MENU
	)
	IF /I "%UDERFINE%"=="VERIFY FILES" (
		CALL :VERIFY-FILE-IDENTITY
		GOTO REFRESH-MENU
	)
ECHO.[0m[1A^| [0;36mType[0m:                                                                                                            [1A
GOTO MENU-INPUT
:CHOICE-INPUTS
SET /P "=[34;61H "<NUL
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
ENDLOCAL
IF EXIST LET.DEBUG ECHO.%CHOICE.INPUT%   
IF /I %CHOICE.INPUT%.==A. GOTO MAP
IF /I %CHOICE.INPUT%.==E. GOTO CHARACTER
IF /I %CHOICE.INPUT%.==. CALL "%EVENT%"&GOTO MENU
IF /I %CHOICE.INPUT%.==P. GOTO MAP
IF /I %CHOICE.INPUT%.==Q. GOTO QUESTS
IF /I %CHOICE.INPUT%.==S. GOTO SETTINGS
IF /I %CHOICE.INPUT%.==W. GOTO SHOP
IF /I %CHOICE.INPUT%.==X. (
	SET "SHOP.TAB=1"
	GOTO SHOP
)
IF /I %CHOICE.INPUT%.==C. (
	SET "SHOP.TAB=2"
	GOTO SHOP
)
IF /I %CHOICE.INPUT%.==Z. (
	SET "SHOP.TAB=3"
	GOTO SHOP
)
IF /I %CHOICE.INPUT%.==V. GOTO CREDITS
IF /I %CHOICE.INPUT%.==. START "" "https://github.com/136MasterNR/Battles-of-Batch#menu-40"
IF /I %CHOICE.INPUT%.==I. GOTO INVENTORY
IF /I %CHOICE.INPUT%.==R. (MODE CON:COLS=%COLS% LINES=%LINES%&GOTO MENU)
IF /I %CHOICE.INPUT%.==. (
	IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 TASKKILL /F /FI "WINDOWTITLE eq wscript.exe" /T>NUL
	GOTO RESTART
)
IF /I %CHOICE.INPUT%.==. GOTO TERMINAL
IF /I %CHOICE.INPUT%.==. (
	IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 TASKKILL /F /FI "WINDOWTITLE eq wscript.exe" /T>NUL
	EXIT 0
)
IF /I %CHOICE.INPUT%.==. GOTO RESET
IF /I %CHOICE.INPUT%.==. (
	CALL "%UPDATER%" MANUAL
	GOTO MENU
)
IF /I %CHOICE.INPUT%.==. (
	IF DEFINED RAINBOWMODE ( SET "RAINBOWMODE=" ) ELSE SET "RAINBOWMODE=TRUE"
	GOTO REFRESH-MENU
)
GOTO CHOICE-INPUTS
:DEV
TITLE DEV
SET UDERFINE=
SETLOCAL ENABLEDELAYEDEXPANSION
%INPUT% "PROMPT=[u[0m" "length=13"
ENDLOCAL&SET UDERFINE=%UDERFINE%
ENDLOCAL
 IF /I "%UDERFINE%"=="BACK" GOTO S-MENU
GOTO DEV
:TERMINAL
PUSHD "%CD%\DATA\cmd"
CLS
TITLE %TITLE%Command Line Enviroment
ECHO.Battles of Batch [Version %VERCODE% / %VERTYPE% %VERS%]
ECHO.^(^!^) Run "EXIT" to return.[H
CMD /K "VER&PROMPT !^> "
PUSHD "..\.."
GOTO MENU
:CREDITS
TITLE %TITLE%Credits
CLS
ECHO.[ PROGRAMMING ]
ECHO.Everything by "136MasterNR"
ECHO.
ECHO.[ STORY ]
ECHO.Directed by "136MasterNR" ^& "johnypro150"
ECHO.
ECHO.[ ASCII-ART ]
ECHO.Character Designs by "136MasterNR", "asciiart.eu", "patorjk.com"
ECHO.Layout Designs by "136MasterNR"
ECHO.
ECHO.[ SOUNDS ]
ECHO.Menu Soundtrack by "Alexander Nakarada"
ECHO.Boss Soundtrack by "pedi me arxes" (Made For This Project)
ECHO.Other Soundtracks by "Unwind Station"
ECHO.
ECHO.[ SFX ]
ECHO.Swing Sound Effects by "SOUND and IMAGE FX"
ECHO.Other Sound Effects by "epicstockmedia.com"
ECHO.
ECHO.[ TESTERS ]: "The Purge King (Latest)", "AgentANP (Latest)", "ComradeTurtle", "JayKayHere3987",
ECHO.             "2002Spiele (Latest)", "BlackStorm (Latest)"
ECHO.
ECHO.
ECHO.%RGB.TRUE%DISCLAIMER: Any unauthorized Assets used for this project are not claimed by us, and are used with no copyright
ECHO.            statements from the authors. You can find the true author's watermarks ^& names below:[0m
ECHO.[1msnd[ASCII:MAN^&AXE], Donovan Bake[ASCII:DIAMOND], Nobody[ASCII:BANNER], Donovan Bake/dwb[ASCII:BIRD], jgs[ASCII:BAT][0m
ECHO.
ECHO.[0mPress any key to return...[?47l
PAUSE>NUL
GOTO S-MENU
:CHARACTER
TITLE %TITLE%Character ^& Equipment
COLOR 08
ECHO.[?25l[1;37m[20H[49C
ECHO.[45C.-------------------------.
ECHO.[45C^|   [1mReading Player Data[0m   ^|
ECHO.[45C^|          [s               ^|
ECHO.[45C^|     [1mPlease Wait ...[0m     ^|
ECHO.[45C'-------------------------'
SET ITEMS.IS=
SET WEAPON.IS=
ECHO.[u  0%%
::Default enemy locations
SET LOC.W1=87
SET LOC.W2=92
SET LOC.W3=86
SET LOC.H1=4
SET LOC.H2=13
SET LOC.H3=22
ECHO.[u  2%%
::CALL "%ITEMS.LOADER%" REGISTER
ECHO.[u 19%%
CALL "%ITEMS.LOADER%" LIST
ECHO.[u 46%%
CALL "%ITEMS.LOADER%" LIST_EQ
ECHO.[u 63%%
CALL "%ITEMS.LOADER%" WEAPONS
ECHO.[u 79%%
CALL "%ITEMS.LOADER%" MATERIALS
ECHO.[u 91%%
CALL "%CHARACTER%" MAIN
ECHO.[u 98%%
SET /A STAT.NUM.HP=%SKILL.HP%*100
SET /A STAT.NUM.ATK=(%SKILL.ATK%*50)+EQUIP.BONUS_ATK
SET /A STAT.NUM.CRIT_RATE=%SKILL.CRIT_RATE%*5
ECHO.[u100%%
IF A==A (
ECHO.[?25l[H[0m.--.----------------------------------------------------------------------------------------------------------------.
ECHO.^|Q ^|                                                                                                                ^|
ECHO.^|--' .-----------------.                      .-----------------------.                    .----------------------. ^|
ECHO.^|    : Press Z to view :                   .--: %RGB%158;177;255mCharacter[0m ^& %RGB%133;255;196mEquipment[0m :--.                 : Press X to customize : ^|
ECHO.^|    : your history .--'                .--'  '-----------------------'  '--.              '----. your appearance : ^|
ECHO.^|    '-------------' .-----: %RGB%252;255;179mName[0m :-----:                                   :----: %RGB.TRUE%Health[0m :----. '----------------' ^|
ECHO.^|                    : %RGB%253;255;209m^>[0m                :        %C.FRAME_0%       : %RGB%191;255;186m+[0m [s               :                    ^|[u%STAT.NUM.HP%[u[55DWanderer
ECHO.^|                    '------------------:        %C.FRAME_1%       :------------------'                    ^|
ECHO.^|                                       :        %C.FRAME_2%       :                                       ^|
ECHO.^|                     .----: %RGB%122;255;126mMoney[0m :----:        %C.FRAME_3%       :--: %RGB.FALSE%Strength[0m :---.                     ^|
ECHO.^|                     : %RGB%179;255;181m$[0m               :        %C.FRAME_4%       : %RGB%245;105;105m╀[0m [s              :                     ^|[u%STAT.NUM.ATK%[u[54D%PLAYER.MONEY.INTF%
ECHO.^|                     '-----------------:        %C.FRAME_5%       :-----------------'                     ^|
ECHO.^|                                       :        %C.FRAME_6%       :                                       ^|
ECHO.^|                     .----: %RGB.LVL%Level[0m :----:        %C.FRAME_7%       :--: %RGB%255;201;125mCrit Rate[0m :--.                     ^|
ECHO.^|                     : %RGB%194;228;255m↑[0m               :        %C.FRAME_8%       : %RGB%255;209;143m֍[0m [s              :                     ^|[u%STAT.NUM.CRIT_RATE%%%[u[54D%PLAYER.LVL%
ECHO.^|                     '-----------------:        %C.FRAME_9%       :-----------------'                     ^|
ECHO.^|                                       :                                   :                                       ^|
ECHO.^|                       .----: %RGB%176;255;247mExp[0m :----:--------.                 .--------:--: %RGB%161;250;255mDefense[0m :--.                       ^|
ECHO.^|                       : %RGB%199;255;249m•[0m             :         '---------------'         : %RGB%201;252;255m▲[0m [s            :                       ^|[u0[u[52D%PLAYER.XP%
ECHO.^|                       '---------------'                                   '---------------'                       ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|          Press [4mA[24m to equip an Item                                               Press [4mD[24m to equip a Weapon         ^|
ECHO.^|      .--------.-----------.--------.     .--------.-----------.--------.     .--------.-----------.--------.      ^|
ECHO.^|      : .-'-.- :   Items   : -.-'-. :     : -/\/\- : Materials : -/\/\- :     : -^|---- :  Weapons  : ----^|- :      ^|
ECHO.^|      '--------'-----------'--------'     '--------'-----------'--------'     '--------'-----------'--------'      ^|
ECHO.^|      . - - : EQUIPPED  ITEMS : - - .     . - - : OWNED MATERIALS : - - .     . - - : EQUIPPED WEAPON : - - .      ^|
ECHO.^|      : 1:                          :     : [s                            :     :                             :      ^|
ECHO.^|      : 2:                          :     :                             :     '                             '      ^|
ECHO.^|      : 3:                          :     :                             :     . - - :  OWNED WEAPONS  : - - .      ^|
ECHO.^|      : 4:                          :     :                             :     :                             :      ^|
ECHO.^|      '                             '     :                             :     :                             :      ^|
ECHO.^|      . - - - : OWNED ITEMS : - - - .     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :                             :     :                             :     :                             :      ^|
ECHO.^|      :  Press [4mA[24m to view all Items  :     :                             :     : Press [4mD[24m to view all Weapons :      ^|
ECHO.^|      '-----------------------------'     '-----------------------------'     '-----------------------------'      ^|
ECHO.^|                                                                                                                   ^|
ECHO.'-------------------------------------------------------------------------------------------------------------------'[22A
)
SETLOCAL ENABLEDELAYEDEXPANSION
SET UI.POS=[12C
IF NOT DEFINED ITEM.EQ_CNT (ECHO.%UI.POS%EMPTY) ELSE FOR /L %%A IN (1,1,%ITEM.EQ_CNT%) DO (IF !ITEM.EQ_NAME.%%A!==EMPTY (ECHO.%UI.POS%EMPTY) ELSE (CALL :INVENTORY-EQUIPPED %%A !ITEM.EQ_NAME.%%A!))
ECHO.[1B
SET UI.POS=[9C
IF %ITEM.REG_CNT% GTR 11 (SET TMP.ITEM.REG_CNT=11) ELSE SET TMP.ITEM.REG_CNT=%ITEM.REG_CNT%
SET /A MORE_HIDDEN=%ITEM.REG_CNT%-11
IF %MORE_HIDDEN% EQU 1 (SET MORE_HIDDEN=  ... ^(%MORE_HIDDEN% Hidden Item^) ...) ELSE IF %MORE_HIDDEN% LEQ 9 (SET MORE_HIDDEN= ... ^(%MORE_HIDDEN% Hidden Item/s^) ...) ELSE (SET MORE_HIDDEN=  ... ^(Hidden Items^) ...)
IF %ITEM.REG_CNT%==0 (ECHO.%UI.POS% You do not own any items) ELSE FOR /L %%A IN (1,1,%TMP.ITEM.REG_CNT%) DO (ECHO.%UI.POS%!ITEM.REG_NAME.%%A! ^(x!ITEM.REG_LVL.%%A!^))
IF %ITEM.REG_CNT% GTR 11 ECHO.%UI.POS%%MORE_HIDDEN%
SET UI.POS=[81C
IF %MAT.REG_CNT%==0 (ECHO.[u    No materials owned) ELSE FOR /L %%A IN (1,1,%MAT.REG_CNT%) DO (
	CALL :MAT_DISPLAY !MAT.REG_NAME.%%A! !MAT.REG_X.%%A! %%A
)
IF %WEAPONS.REG_CNT% GTR 14 (SET TMP.ITEM.REG_CNT=14) ELSE SET TMP.ITEM.REG_CNT=%WEAPONS.REG_CNT%
SET /A MORE_HIDDEN=%WEAPONS.REG_CNT%-14
IF %MORE_HIDDEN% EQU 1 (SET MORE_HIDDEN=  ... ^(%MORE_HIDDEN% Hidden Item^) ...) ELSE IF %MORE_HIDDEN% LEQ 9 (SET MORE_HIDDEN= ... ^(%MORE_HIDDEN% Hidden Item/s^) ...) ELSE (SET MORE_HIDDEN=  ... ^(Hidden Items^) ...)
IF DEFINED WIELDING.WEAPON (ECHO.[u[36C1: !WEAPONS.REG_NAME.%WIELDING.WEAPON%:_= ! ^(+%EQUIP.BONUS_ATK% ATK^)[2B) ELSE (ECHO.[u[36C    No equipped weapons[2B)
SET UI.POS=[81C
IF %WEAPONS.REG_CNT%==0 (ECHO.%UI.POS%     No weapons owned) ELSE FOR /L %%A IN (1,1,%TMP.ITEM.REG_CNT%) DO (
	CALL :WEAPON-GET-INFO !WEAPONS.REG_NAME.%%A! %%A
)
IF %WEAPONS.REG_CNT% GTR 14 ECHO.%UI.POS%%MORE_HIDDEN%
ENDLOCAL
SET /P "=[?25h[2;2H"<NUL
:CHARACTER-RE
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
IF %CHOICE.INPUT%.==. GOTO CHARACTER-RE
IF /I %CHOICE.INPUT%.==R. (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO CHARACTER
)
IF /I %CHOICE.INPUT%.==X. SET /P "=[4C%RGB.FALSE%UI_ERR: CHAR_CUST UNAVAILABLE   [2G"<NUL
IF /I %CHOICE.INPUT%.==Z. SET /P "=[4C%RGB.FALSE%UI_ERR: CHAR_HIST UNAVAILABLE   [2G"<NUL
IF /I %CHOICE.INPUT%.==A. IF %ITEM.REG_CNT%==0 (SET /P "=[4C%RGB.FALSE%UI_ERR: ITEMS LIST IS EMPTY   [2G"<NUL) ELSE GOTO INV-CHOOSE_ITEM-RE
IF /I %CHOICE.INPUT%.==D. IF %WEAPONS.REG_CNT%==0 (SET /P "=[4C%RGB.FALSE%UI_ERR: WEAPONS LIST IS EMPTY   [2G"<NUL) ELSE GOTO INV-CHOOSE_WEAPON-RE
IF /I %CHOICE.INPUT%.==. START "" "https://github.com/136MasterNR/Battles-of-Batch#character--equipment-43"
IF /I %CHOICE.INPUT%==Q GOTO S-MENU
GOTO CHARACTER-RE

:INVENTORY
TITLE %TITLE%Inventory
ECHO.%ITEMS.IS%
IF DEFINED ITEMS.IS IF NOT DEFINED WEAPON.IS (
	ENDLOCAL
	GOTO INV-CHOOSE_WEAPON
) ELSE (
	CLS
	ECHO.You do not own any items.
	PAUSE>NUL
	GOTO S-MENU
)
:INV-CHOOSE_ITEM
CALL "%ITEMS.LOADER%" REGISTER
CALL "%ITEMS.LOADER%" LIST
CALL "%ITEMS.LOADER%" LIST_EQ
CALL "%ITEMS.LOADER%" WEAPONS
:INV-CHOOSE_ITEM-RE
CLS
ECHO.[?25l[0m[HFYI: This user interface is a [1;31mprototype[0m. Any minor visual bugs that were found will not be fixed in the near future.[2;0H[1mItems:
SETLOCAL ENABLEDELAYEDEXPANSION
SET ITEMS.IS=
SET WEAPON.IS=
IF NOT DEFINED ITEM.REG_CNT (
	SET ITEMS.IS=EMPTY
	ECHO.EMPTY
) ELSE FOR /L %%A IN (1,1,%ITEM.REG_CNT%) DO (
	ECHO.   Slot - Name: !ITEM.REG_NAME.%%A!, Amount: !ITEM.REG_LVL.%%A!
)
ECHO.
ECHO.EQUIPPED:
SET UI.POS=[3C
IF NOT DEFINED ITEM.EQ_CNT ( ECHO.EMPTY ) ELSE FOR /L %%A IN (1,1,%ITEM.EQ_CNT%) DO (
	IF !ITEM.EQ_NAME.%%A!==EMPTY ( ECHO.%UI.POS%EMPTY ) ELSE (
		CALL :INVENTORY-EQUIPPED %%A !ITEM.EQ_NAME.%%A!
	)
)
ENDLOCAL&SET WEAPON.IS=%WEAPON.IS%&SET ITEMS.IS=%ITEMS.IS%
ECHO.[0m[1m[1BGuide For Items Section:                                            Guide For Weapons Section:
ECHO.[0m Press W or S to navigate between items/slots.                       Press E to change your Weapon equipment.
ECHO. Press A to confirm the item you want to add.                        Press A to confirm the chosen weapon.
ECHO. Press Q after selecting an item to reselect an item.                Press Q to return to the character ui.  
ECHO. Press CTRL X to clear your equipped items.                                                [s%RGB.COIN%
:INV-CHOOSE_ITEM
TITLE %TITLE%Inventory [%INV_CHOICE%^|%INV_CHOICE_SLOT%]
SET /A INV_CHOICE.UI=%INV_CHOICE%+2
SET /P "=[%INV_CHOICE.UI%;2H>[1C"<NUL
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
ENDLOCAL
IF %CHOICE.INPUT%.==. GOTO INVENTORY
IF /I %CHOICE.INPUT%==W IF NOT %INV_CHOICE% LEQ 1 (
	ECHO.[%INV_CHOICE.UI%;2H [1A
	SET /A INV_CHOICE-=1
	GOTO INV-CHOOSE_ITEM-RE
)
IF /I %CHOICE.INPUT%==S IF NOT %INV_CHOICE% GEQ %ITEM.REG_CNT% (
	ECHO.[%INV_CHOICE.UI%;2H [1A
	SET /A INV_CHOICE+=1
	GOTO INV-CHOOSE_ITEM-RE
)
IF /I %CHOICE.INPUT%==C (
	ECHO.[2D 
	GOTO INV-CHOOSE_WEAPON-RE
)
IF /I %CHOICE.INPUT%== (
	FOR /F "tokens=*" %%A IN (%PLAYERDATA.EQ%) DO (
		ECHO.EMPTY>>"%PLAYERDATA.EQ%.new"
	)
	MOVE "%PLAYERDATA.EQ%.new" "%PLAYERDATA.EQ%" >NUL
	DEL "%PLAYERDATA.EQ%.new"
	GOTO INVENTORY
)
IF /I %CHOICE.INPUT%==Q (
	GOTO CHARACTER
)
IF /I %CHOICE.INPUT%==R (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO INVENTORY
)
IF /I NOT %CHOICE.INPUT%==A GOTO INV-CHOOSE_ITEM
:INV-CHOOSE_SLOT
TITLE %TITLE%Inventory [%INV_CHOICE%^|%INV_CHOICE_SLOT%]
SET /A INV_CHOICE_SLOT.UI=%ITEM.REG_CNT%+5
SET /A INV_CHOICE_SLOT_MAX.UI=%ITEM.REG_CNT%+4+%ITEM.EQ_CNT%
SET /A INV_CHOICE_SLOT.POS=%ITEM.REG_CNT%+4+%INV_CHOICE_SLOT%
SET /P "=[%INV_CHOICE_SLOT.POS%;2H>[1C"<NUL
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
ENDLOCAL
IF %CHOICE.INPUT%.==. GOTO INVENTORY
IF /I %CHOICE.INPUT%==W IF NOT %INV_CHOICE_SLOT.POS% LEQ %INV_CHOICE_SLOT.UI% (
	ECHO.[%INV_CHOICE_SLOT.POS%;2H [1A
	SET /A INV_CHOICE_SLOT-=1
	GOTO INV-CHOOSE_SLOT
)
IF /I %CHOICE.INPUT%==S IF NOT %INV_CHOICE_SLOT.POS% GEQ %INV_CHOICE_SLOT_MAX.UI% (
	ECHO.[%INV_CHOICE_SLOT.POS%;2H [1A
	SET /A INV_CHOICE_SLOT+=1
	GOTO INV-CHOOSE_SLOT
)
IF /I %CHOICE.INPUT%==Q (
	ECHO.[2D [?47h
	GOTO INV-CHOOSE_ITEM
)
IF /I %CHOICE.INPUT%== (
	FOR /F "tokens=*" %%A IN (%PLAYERDATA.EQ%) DO (
		ECHO.EMPTY>>"%PLAYERDATA.EQ%.new"
	)
	MOVE "%PLAYERDATA.EQ%.new" "%PLAYERDATA.EQ%" >NUL
	DEL "%PLAYERDATA.EQ%.new"
	GOTO INVENTORY
)
IF /I %CHOICE.INPUT%== (
	FOR /F "tokens=*" %%A IN (%PLAYERDATA.EQ%) DO (
		ECHO.EMPTY>>"%PLAYERDATA.EQ%.new"
	)
	MOVE "%PLAYERDATA.EQ%.new" "%PLAYERDATA.EQ%" >NUL
	GOTO INVENTORY
)
IF /I %CHOICE.INPUT%==R (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO INVENTORY
)
IF /I %CHOICE.INPUT%==A (
	CALL "%ITEMS.LOADER%" EQUIP %INV_CHOICE_SLOT% %INV_CHOICE%
	GOTO INV-CHOOSE_ITEM
) ELSE GOTO INV-CHOOSE_SLOT
:INVENTORY-EQUIPPED
SET TMP.EQ_N=!ITEM.EQ_NAME.%1!
ECHO.%UI.POS%!ITEM.REG_NAME.%2! (x!ITEM.REG_LVL.%TMP.EQ_N%!)
EXIT /B 0
:MAT_DISPLAY
SET TMP.DISPLAY=%1
ECHO.[u[1A[%3B%TMP.DISPLAY:_= % ^(x%2^)
EXIT /B 0
:INV-CHOOSE_WEAPON
CALL "%ITEMS.LOADER%" REGISTER
CALL "%ITEMS.LOADER%" LIST
CALL "%ITEMS.LOADER%" LIST_EQ
CALL "%ITEMS.LOADER%" WEAPONS
:INV-CHOOSE_WEAPON-RE
CLS
::ECHO.[?25l[0m[HFYI: This user interface is a [1;31mprototype[0m. Any minor visual bugs that were found will not be fixed in the near future.
TITLE %TITLE%Inventory [%W_INV_CHOICE%]
ECHO.[?25l[2J[0m[H{Prototype} Press Q to return[E
SETLOCAL ENABLEDELAYEDEXPANSION
SET UI.POS=[3C
IF NOT DEFINED WEAPONS.REG_CNT (
	SET WEAPON.IS=EMPTY
	ECHO.[71CEMPTY
) ELSE FOR /L %%A IN (1,1,%WEAPONS.REG_CNT%) DO (
	CALL :WEAPON-GET-INFO !WEAPONS.REG_NAME.%%A! %%A
)
IF DEFINED WIELDING.WEAPON (
	ECHO.[1B[2CEQUIPPED: !WEAPONS.REG_NAME.%WIELDING.WEAPON%:_= !
) ELSE (
	ECHO.[1B[2CEQUIPPED: EMPTY
)
ENDLOCAL
ECHO.[0m[1m[1BGuide For Items Section:                                            Guide For Weapons Section:
ECHO.[0m Press W or S to navigate between items/slots.                       Press E to change your Weapon equipment.
ECHO. Press A to confirm the item you want to add.                        Press A to confirm the chosen weapon.
ECHO. Press Q after selecting an item to reselect an item.                Press Q to return to the character ui.  
ECHO. Press CTRL X to clear your equipped items.                                                [s%RGB.COIN%
:INV-CHOOSE_WEAPON-PRE
SET /A W_INV_CHOICE.UI=%W_INV_CHOICE%+2
SET /P "=[%W_INV_CHOICE.UI%;2H>[1C"<NUL
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
IF %CHOICE.INPUT%.==. GOTO INVENTORY
IF /I %CHOICE.INPUT%==W IF NOT %W_INV_CHOICE% LEQ 1 (
	ECHO.[%W_INV_CHOICE.UI%;2H [1A
	SET /A W_INV_CHOICE-=1
	GOTO INV-CHOOSE_WEAPON-RE
)
IF /I %CHOICE.INPUT%==S IF NOT %W_INV_CHOICE% GEQ %WEAPONS.REG_CNT% (
	ECHO.[%W_INV_CHOICE.UI%;2H [1A
	SET /A W_INV_CHOICE+=1
	GOTO INV-CHOOSE_WEAPON-RE
)
IF /I %CHOICE.INPUT%== (
	SET REL.W=TRUE
	CALL "%ITEMS.LOADER%" UNEQUIP_W %W_INV_CHOICE%
	GOTO INV-CHOOSE_WEAPON
)
IF /I %CHOICE.INPUT%==E (
	ECHO.[2D 
	IF DEFINED ITEMS.IS (GOTO CHARACTER) ELSE GOTO INV-CHOOSE_ITEM-RE
)
IF /I %CHOICE.INPUT%==Q (
	ECHO.[2D 
	GOTO CHARACTER
)
IF /I %CHOICE.INPUT%==R (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO INV-CHOOSE_WEAPON
)
IF /I %CHOICE.INPUT%==A (	
	SET REL.W=TRUE
	CALL "%ITEMS.LOADER%" EQUIP_W %W_INV_CHOICE%
	GOTO INV-CHOOSE_WEAPON
) ELSE GOTO INV-CHOOSE_WEAPON-RE
:WEAPON-DISPLAY-INFO
::SET TMP.W_NAME=%1
::ECHO.[u, DMG: !I.%1.DMG!, TYPE: !I.%1.TYPE![E!I.%1.DESC!
ECHO.    :[45C:
SET "STR=%1"
ECHO.   :  %STR%  -  Strength: +!I.%1.DMG![G[51C:
ECHO.   ':[7CPress I for more[G[50C:'
::ECHO. [0;30m!WEAPONS.REG_NAME.%2![0m  Extra: !I.%1.DESC.1:_= ! !I.%1.DESC.2:_= !!I.%1.DESC.3:_= !!I.%1.DESC.4:_= !!I.%1.DESC.5:_= !!I.%1.DESC.6:_= !!I.%1.DESC.7:_= !
EXIT /B 0
:WEAPON-GET-INFO
SET TMP.NAME=%1
ECHO.%UI.POS%%TMP.NAME:_= % - (↑!WEAPONS.REG_LVL.%2!)
EXIT /B 0

:MAP
TITLE %TITLE%Map
ECHO.[?25l[0m[H.+-----------------------------------------------------------------------------------------------------------------+.
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|[s
ECHO.'+-----------------------------------------------------------------------------------------------------------------+'[33B
ECHO.^|     ^|`-._/\_.-`^|                                                                                 ^|`-._/\_.-`^|     ^|
ECHO.^|     ^|    ^|^|    ^|                                                                                 ^|    ^|^|    ^|     ^|
IF NOT "%SHORTCUTS.VALUE%"=="TRUE" (
	ECHO.[1A[41C[1;30mType "[0mstart[1;30m" or "[0mplay[1;30m" to begin the level.[0m
)
ECHO.^|     ^|___o()o___^|                                                                                 ^|___o()o___^|     ^|
IF NOT "%SHORTCUTS.VALUE%"=="TRUE" (
	ECHO.[1A[31C[1;30mType "[0mchapter {number}[1;30m" to change chapter. E.g. "chapter 2"[0m
)
ECHO.^|     ^|__((^<^>))__^|                                                                                 ^|__((^<^>))__^|     ^|
IF NOT "%SHORTCUTS.VALUE%"=="TRUE" (
	ECHO.[1A[31C[1;37mType "forward" to go to the next level, "prev" for previous[0m
)
IF "%SHORTCUTS.VALUE%"=="TRUE" (
	ECHO.^|     \   o\/o   /                                                                                 \   o\/o   /     ^|
	ECHO.^|      \   ^|^|   /                          [0mPress "%RGB.CYAN%A[0m" or "%RGB.CYAN%P[0m" to begin the level.[0m                     \   ^|^|   /      ^|
	ECHO.^|       \  ^|^|  /               [0m Press "[1;37mC[0m" to jump 7 levels forward or "[1;37mZ[0m" to go backwards.[0m           \  ^|^|  /       ^|
	ECHO.^|        '.^|^|.'                   [0mPress "%RGB.YELLOW%D[0m" to move to the next level, "%RGB.YELLOW%S[0m" for previous.[0m              '.^|^|.'        ^|
	ECHO.^|          ''                                                                                           ''          ^|
) ELSE (
	ECHO.^|     \   o\/o   /             .---------------------------------------------------------.         \   o\/o   /     ^|
	ECHO.^|      \   ^|^|   /              ^|                                                         ^|          \   ^|^|   /      ^|
	ECHO.^|       \  ^|^|  /               ^|                                                         ^|           \  ^|^|  /       ^|
	ECHO.^|        '.^|^|.'                ^|                                                         ^|            '.^|^|.'        ^|
	ECHO.^|          ''                  '---------------------------------------------------------'              ''          ^|
)
ECHO.'-._______________________________________________________________________________________________________________.-'[4A[u
:MAP-RE
CALL "%MAP.LOAD%\limit.cmd"
CALL "%MAP.LOAD%\details.cmd" %SELECTED% %CHAPTER%
ECHO.
IF %SELECTED% LEQ 7 (CALL "%MAP.LOAD%\c1.cmd") ELSE CALL "%MAP.LOAD%\c2.cmd"
:MAP-INPUT
SET UDERFINE=
IF "%SHORTCUTS.VALUE%"=="TRUE" (
	GOTO :MAP-CHOICE
)
SET "INPUT_PART=map"
SETLOCAL ENABLEDELAYEDEXPANSION
%INPUT% "PROMPT=|[45;0H|       \  ||  /               |                       [1m[s[?25h" "LENGTH=10"
ECHO.[45;52H                       
ENDLOCAL&SET UDERFINE=%UDERFINE%
ENDLOCAL
SET "INPUT_PART=nul"
 IF NOT DEFINED UDERFINE GOTO S-MENU
  IF /I "%UDERFINE%"=="BACK" GOTO S-MENU
   IF /I "%UDERFINE%"=="EXIT" GOTO S-MENU
    IF /I "%UDERFINE%"=="GO BACK" GOTO S-MENU
     IF /I "%UDERFINE%"=="MENU" GOTO S-MENU
	  IF /I "%UDERFINE%"=="RETURN" GOTO S-MENU
  IF /I "%UDERFINE%"=="SET" GOTO SETTINGS
   IF /I "%UDERFINE%"=="SETT" GOTO SETTINGS
	IF /I "%UDERFINE%"=="SETTING" GOTO SETTINGS
	 IF /I "%UDERFINE%"=="SETTINGS" GOTO SETTINGS
   IF /I "%UDERFINE%"=="PLAY" GOTO PRE_LOAD
  IF /I "%UDERFINE%"=="START" GOTO PRE_LOAD
    IF /I "%UDERFINE%"=="FIGHT" GOTO PRE_LOAD
	 IF /I "%UDERFINE%"=="BATTLE" GOTO PRE_LOAD
	  IF /I "%UDERFINE%"=="START GAME" GOTO PRE_LOAD
  IF /I "%UDERFINE%"=="REFRESH" (MODE CON:COLS=%COLS% LINES=%LINES%&GOTO MAP)
   IF /I "%UDERFINE%"=="RE" (MODE CON:COLS=%COLS% LINES=%LINES%&GOTO MAP)
IF /I "%UDERFINE%"=="FORWARD" (
	SET /A SELECTED=SELECTED+1
	CALL "%MAP.LOAD%\limit.cmd"
	IF %SELECTED% LEQ 7 (
		IF %SELECTED%==7 (
			GOTO MAP
		)
		CALL "%MAP.LOAD%\c1.cmd" NUMS
	) ELSE (
		CALL "%MAP.LOAD%\c2.cmd" NUMS
	)
)
IF /I "%UDERFINE%"=="PREV" (
	SET /A SELECTED=SELECTED-1
	CALL "%MAP.LOAD%\limit.cmd"
	IF %SELECTED% LEQ 8 (
		IF %SELECTED%==8 (
			GOTO MAP
		)
		CALL "%MAP.LOAD%\c1.cmd" NUMS
	) ELSE (
		CALL "%MAP.LOAD%\c2.cmd" NUMS
	)
	GOTO MAP-INPUT
)
IF /I "%UDERFINE:~0,8%"=="CHAPTER " (
	SET "VAR="&FOR /F "DELIMS=0123456789" %%I IN ("%UDERFINE:~8%") DO SET VAR=%%I
	IF NOT DEFINED VAR (
		SET SELECTED=0
		SET /A SELECTED=7*%UDERFINE:~8%
		GOTO MAP
	)
)
GOTO MAP-INPUT 
:MAP-CHOICE
SET /P "=[44;44H"<NUL
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
ENDLOCAL
IF %CHOICE.INPUT%.==. GOTO PRE_LOAD
IF /I %CHOICE.INPUT%==A GOTO PRE_LOAD
IF /I %CHOICE.INPUT%==B GOTO S-MENU
IF /I %CHOICE.INPUT%==S (
	SET /A SELECTED=SELECTED-1
	CALL "%MAP.LOAD%\limit.cmd"
	IF %SELECTED% LEQ 8 (
		IF %SELECTED%==8 (
			GOTO MAP-RE
		)
		CALL "%MAP.LOAD%\c1.cmd" NUMS
	) ELSE (
		CALL "%MAP.LOAD%\c2.cmd" NUMS
	)
	GOTO MAP-INPUT
)
IF /I %CHOICE.INPUT%==D (
	SET /A SELECTED=SELECTED+1
	CALL "%MAP.LOAD%\limit.cmd"
	IF %SELECTED% LEQ 7 (
		IF %SELECTED%==7 (
			GOTO MAP-RE
		)
		CALL "%MAP.LOAD%\c1.cmd" NUMS
	) ELSE (
		CALL "%MAP.LOAD%\c2.cmd" NUMS
	)
)
IF /I %CHOICE.INPUT%==Q GOTO S-MENU
IF /I %CHOICE.INPUT%==R ( 
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO MAP
)
IF /I %CHOICE.INPUT% GEQ 1 IF %CHOICE.INPUT% LEQ 7 (
	SET /A AF=7*CHAPTER-7
	SET /A SELECTED=%CHOICE.INPUT%+AF
	GOTO MAP
)
IF /I %CHOICE.INPUT%==C (
	SET /A SELECTED=SELECTED+7
	GOTO MAP
)
IF /I %CHOICE.INPUT%==Z (
	SET /A SELECTED=SELECTED-7
	GOTO MAP
)
IF /I %CHOICE.INPUT%.==. START "" "https://github.com/136MasterNR/Battles-of-Batch#map-41"
GOTO MAP-CHOICE
:SHOP
CALL "%PLAYERDATA.LOAD%"
IF "%SHOP.TAB%"=="1" CALL "%UI.ITEMS%"
IF "%SHOP.TAB%"=="2" CALL "%UI.SKILLS%"
SET UDERFINE=
:SHOP-RE
IF "%SHOP.TAB%"=="1" SET "INPUT_PART=items"
IF "%SHOP.TAB%"=="2" SET "INPUT_PART=skills"
IF "%SHOP.TAB%"=="3" (
	GOTO CRAFT-SHOP
) ELSE (
	SETLOCAL ENABLEDELAYEDEXPANSION
	%INPUT% "PROMPT=[u[0m[?25h" "length=13"
)
ENDLOCAL&SET UDERFINE=%UDERFINE%
ENDLOCAL
SET "INPUT_PART=nul"
 IF "%UDERFINE%"==") " (
	IF NOT "%SHOP.TAB%"=="3" SET /P "=|"<NUL
	GOTO SHOP-RE
 )
  IF /I "%UDERFINE%"=="BACK" GOTO S-MENU
   IF /I "%UDERFINE%"=="EXIT" GOTO S-MENU
    IF /I "%UDERFINE%"=="GO BACK" GOTO S-MENU
     IF /I "%UDERFINE%"=="MENU" GOTO S-MENU
	  IF /I "%UDERFINE%"=="RETURN" GOTO S-MENU
	   IF /I "%UDERFINE%"=="Q" GOTO S-MENU
IF /I "%UDERFINE%"=="SWITCH" IF %SHOP.TAB% LEQ 2 (
	SET /A SHOP.TAB+=1
) ELSE (
	SET SHOP.TAB=1
)
IF /I "%UDERFINE%"=="SKILLS" SET "SHOP.TAB=2"
IF /I "%UDERFINE%"=="SKILL" SET "SHOP.TAB=2"
IF /I "%UDERFINE%"=="ITEMS" SET "SHOP.TAB=1"
IF /I "%UDERFINE%"=="ITEM" SET "SHOP.TAB=1"
IF /I "%UDERFINE%"=="CRAFT" SET "SHOP.TAB=3"
IF "%SHOP.TAB%"=="1" (
	IF /I "%UDERFINE:~0,4%"=="HEAL" (
		CALL "%ITEMS.LOADER%" SHOP-ADD Heal %SHOP.MAX.HEAL% %SHOP.PRICE.HEAL% %SHOP.LVLREQ.HEAL% %UDERFINE:~5%
	)
	IF /I "%UDERFINE:~0,8%"=="BUY HEAL" (
		IF "%UDERFINE%"=="BUY HEAL" SET UDERFINE=%UDERFINE% 1
		CALL "%ITEMS.LOADER%" SHOP-ADD Heal %SHOP.MAX.HEAL% %SHOP.PRICE.HEAL% %SHOP.LVLREQ.HEAL% %UDERFINE:~9%
	)
	IF /I "%UDERFINE:~0,4%"=="BOMB" (
		IF "%UDERFINE%"=="BOMB" SET UDERFINE=%UDERFINE% 1
		CALL "%ITEMS.LOADER%" SHOP-ADD Bomb %SHOP.MAX.BOMB% %SHOP.PRICE.BOMB% %SHOP.LVLREQ.BOMB% %UDERFINE:~5%
	)
	IF /I "%UDERFINE:~0,8%"=="BUY BOMB" (
		IF "%UDERFINE%"=="BUY BOMB" SET UDERFINE=%UDERFINE% 1
		CALL "%ITEMS.LOADER%" SHOP-ADD Bomb %SHOP.MAX.BOMB% %SHOP.PRICE.BOMB% %SHOP.LVLREQ.BOMB% %UDERFINE:~9%
	)
) ELSE (
	IF /I "%UDERFINE%"=="UP ATK" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.ATK% %LVL.REQ.ATK% %SKILL.COST.ATK% 1 SKILL.ATK
	)
	IF /I "%UDERFINE%"=="UP ATTACK" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.ATK% %LVL.REQ.ATK% %SKILL.COST.ATK% 1 SKILL.ATK
	)
	IF /I "%UDERFINE%"=="UP MAINATTACK" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.ATK% %LVL.REQ.ATK% %SKILL.COST.ATK% 1 SKILL.ATK
	)
	IF /I "%UDERFINE%"=="UP MAIN ATTAC" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.ATK% %LVL.REQ.ATK% %SKILL.COST.ATK% 1 SKILL.ATK
	)
	IF /I "%UDERFINE%"=="UP MAIN ATK" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.ATK% %LVL.REQ.ATK% %SKILL.COST.ATK% 1 SKILL.ATK
	)
	IF /I "%UDERFINE%"=="UP CRIT" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.CRIT_RATE% %LVL.REQ.CRIT_RATE% %SKILL.COST.CRIT_RATE% 2 SKILL.CRIT_RATE
	)
	IF /I "%UDERFINE%"=="UP CRIT RATE" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.CRIT_RATE% %LVL.REQ.CRIT_RATE% %SKILL.COST.CRIT_RATE% 2 SKILL.CRIT_RATE
	)
	IF /I "%UDERFINE%"=="UP CRITRATE" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.CRIT_RATE% %LVL.REQ.CRIT_RATE% %SKILL.COST.CRIT_RATE% 2 SKILL.CRIT_RATE
	)
	IF /I "%UDERFINE%"=="UP HP" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.HP% %LVL.REQ.HP% %SKILL.COST.HP% 3 SKILL.HP
	)
	IF /I "%UDERFINE%"=="UP MAX HEALTH" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.HP% %LVL.REQ.HP% %SKILL.COST.HP% 3 SKILL.HP
	)
	IF /I "%UDERFINE%"=="UP MAXHEALTH" (
		CALL "%SKILL.UPGRADE%" %LVL.REQ.HP% %LVL.REQ.HP% %SKILL.COST.HP% 3 SKILL.HP
	)
)
GOTO SHOP
:CRAFT-SHOP
COLOR 08
ECHO.[?25l[1;37m[20H[49C
ECHO.[45C.-------------------------.
ECHO.[45C^|   [1mReading Player Data[0m   ^|
ECHO.[45C^|     [1mPlease Wait ...[0m     ^|
ECHO.[45C'-------------------------'
SET "INPUT_PART=craft"
IF NOT DEFINED VERCODE EXIT
TITLE %TITLE%Craft Shop
CALL "%ITEMS.LOADER%" MATERIALS
CALL "%ITEMS.LOADER%" WEAPONS
>NUL FINDSTR /C:"Dustblade" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.1_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Dustblade%^)    ") || (SET "CRAFT.1_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Cold_Twill" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.2_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Cold_Twill%^)    ") || (SET "CRAFT.2_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Comrade_Hammer" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.3_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Comrade_Hammer%^)    ") || (SET "CRAFT.3_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Stylefi" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.4_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Stylefi%^)    ") || (SET "CRAFT.4_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Flora_Thrower" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.5_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Flora_Thrower%^)    ") || (SET "CRAFT.5_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Trident_of_Gawra" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.6_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Trident_of_Gawra%^)    ") || (SET "CRAFT.6_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Infernal_Blade" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.7_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Infernal_Blade%^)    ") || (SET "CRAFT.7_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Ornate_Cobalt" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.8_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Ornate_Cobalt%^)    ") || (SET "CRAFT.8_FOUND=   ^(Not Owned^)   ")
>NUL FINDSTR /C:"Brainleader" "%PLAYERDATA.WEAPONS%" && (SET "CRAFT.9_FOUND=   ^(Owned ↑%WEAPONS.REG_LVL.Brainleader%^)    ") || (SET "CRAFT.9_FOUND=   ^(Not Owned^)   ")
ECHO.[?25l[H[0m.---------------------------------------------.-------.-------.-------.---------------------------------------------.
ECHO.^|                                           Q ^| [4m[1mCraft[0m ^| Items ^| Skill ^| E                                           ^|
ECHO.^|                                             '-------'-------'-------'                                             ^|
ECHO.[42H^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.^|                                                                                                                   ^|
ECHO.'-------------------------------------------------------------------------------------------------------------------'[1A
:CRAFT-SHOP-RE
IF %CRAFT.SEL%==0 (SET CRAFT.UI_ITEM=Dustblade) ELSE IF %CRAFT.SEL%==1 (SET CRAFT.UI_ITEM=Cold_Twill) ELSE IF %CRAFT.SEL%==2 (SET CRAFT.UI_ITEM=Comrade_Hammer
) ELSE IF %CRAFT.SEL%==3 (SET CRAFT.UI_ITEM=Stylefi) ELSE IF %CRAFT.SEL%==4 (SET CRAFT.UI_ITEM=Flora_Thrower) ELSE IF %CRAFT.SEL%==5 (SET CRAFT.UI_ITEM=Trident_of_Gawra
) ELSE IF %CRAFT.SEL%==6 (SET CRAFT.UI_ITEM=Infernal_Blade) ELSE IF %CRAFT.SEL%==7 (SET CRAFT.UI_ITEM=Ornate_Cobalt
) ELSE IF %CRAFT.SEL%==8 (SET CRAFT.UI_ITEM=Brainleader)
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=> [4m[s%CRAFT.UI_ITEM%[24m <"
CALL "%CENTER%" 30
ENDLOCAL&&SET "CRAFT.UI.CENTER=%STR%"
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=!I.%CRAFT.UI_ITEM%.TYPE:_= !"
CALL "%CENTER%" 12
ENDLOCAL&&SET "CRAFT.UI.TYPE=%STR%"
ENDLOCAL
FOR /F "TOKENS=1,2,3,4,5,6 DELIMS=?" %%A IN ('CALL ECHO.%%I.%CRAFT.UI_ITEM%.MAT%%') DO (	
	SET MAT.1.NAME=%%A
	SET MAT.1.X=%%B
	SET MAT.2.NAME=%%C
	SET MAT.2.X=%%D
	SET MAT.3.NAME=%%E
	SET MAT.3.X=%%F
	>NUL FINDSTR /C:"%%A" "%PLAYERDATA.MATERIALS%" && (
		FOR /F "DELIMS=:" %%N IN ('FINDSTR /I /N %%A "%PLAYERDATA.MATERIALS%"') DO (SET MAT.1.OWNED=%%N) ) || (SET MAT.1.OWNED=0)
	>NUL FINDSTR /C:"%%C" "%PLAYERDATA.MATERIALS%" && (
		FOR /F "DELIMS=:" %%N IN ('FINDSTR /I /N %%C "%PLAYERDATA.MATERIALS%"') DO (SET MAT.2.OWNED=%%N) ) || (SET MAT.2.OWNED=0)
	>NUL FINDSTR /C:"%%E" "%PLAYERDATA.MATERIALS%" && (
		FOR /F "DELIMS=:" %%N IN ('FINDSTR /I /N %%E "%PLAYERDATA.MATERIALS%"') DO (SET MAT.3.OWNED=%%N) ) || (SET MAT.3.OWNED=0)
	)
)
IF NOT %MAT.1.OWNED%==0 CALL SET "MAT.1.OWNED=%%MAT.REG_X.%MAT.1.OWNED%%%"
IF NOT %MAT.2.OWNED%==0 CALL SET "MAT.2.OWNED=%%MAT.REG_X.%MAT.2.OWNED%%%"
IF NOT %MAT.3.OWNED%==0 CALL SET "MAT.3.OWNED=%%MAT.REG_X.%MAT.3.OWNED%%%"
IF %MAT.1.OWNED% GEQ %MAT.1.X% (SET CRAFT.UI.1.OWNED=%MAT.1.OWNED% %RGB.TRUE%√[0m) ELSE (SET CRAFT.UI.1.OWNED=%MAT.1.OWNED% %RGB.FALSE%X[0m)
IF %MAT.2.OWNED% GEQ %MAT.2.X% (SET CRAFT.UI.2.OWNED=%MAT.2.OWNED% %RGB.TRUE%√[0m) ELSE (SET CRAFT.UI.2.OWNED=%MAT.2.OWNED% %RGB.FALSE%X[0m)
IF %MAT.3.OWNED% GEQ %MAT.3.X% (SET CRAFT.UI.3.OWNED=%MAT.3.OWNED% %RGB.TRUE%√[0m) ELSE (SET CRAFT.UI.3.OWNED=%MAT.3.OWNED% %RGB.FALSE%X[0m)
SET /A SEL.Y=(3*%CRAFT.SEL%)+8
IF %CRAFT.NAV% EQU 0 (
	ECHO.[4H^|                                                                                                                   ^|
	ECHO.^|        .-------------------------.                                                                                ^|
	ECHO.^|       /  [1;30m?  ← %RGB%255;204;153mCRAFT WEAPONS[1;30m →  ?[0m  \                   .-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+.                  ^|
	ECHO.^|      :'- - - - - - - - - - - - - -':               .-'                                          '-.               ^|
	ECHO.^|      :.                           .:               :------------: %RGB%153;153;255mMATERIALS REQUIRED[0m :------------:               ^|
	ECHO.^|       :         Dustblade         :                ^|                                              ^|               ^|
	ECHO.^|      :'     [s                      ':               ^|                                              ^|               ^|[u%CRAFT.1_FOUND%
	ECHO.^|      :.                           .:               ^|                                              ^|               ^|
	ECHO.^|       :        Cold Twill         :                ^|                                              ^|               ^|
	ECHO.^|      :'     [s                      ':               ^|                                              ^|               ^|[u%CRAFT.2_FOUND%
	ECHO.^|      :.                           .:               ^|                                              ^|               ^|
	ECHO.^|       :      Comrade Hammer       :                ^|                                              ^|               ^|
	ECHO.^|      :'     [s                      ':               ^|                                              ^|               ^|[u%CRAFT.3_FOUND%
	ECHO.^|      :.                           .:               ^|                                              ^|               ^|
	ECHO.^|       :          Stylefi          :                :------------: %RGB%204;255;204mWEAPON INFORMATION[0m :------------:               ^|
	ECHO.^|      :'     [s                      ':               :                                              :               ^|[u%CRAFT.4_FOUND%
	ECHO.^|      :.                           .:               '-.                                          .-'               ^|
	ECHO.^|       :       Flora Thrower       :                  : - %RGB%255;255;204mWeapon Type[0m -          - %RGB%255;102;102mBase Damage[0m - :                 ^|
	ECHO.^|      :'     [s                      ':                 :                                          :                 ^|[u%CRAFT.5_FOUND%
	ECHO.^|      :.                           .:                 :                                          :                 ^|
	ECHO.^|       :      Trident of Gawra     :                  :             - %RGB%204;255;255mBONUS EFFECT[0m -             :                 ^|
	ECHO.^|      :'     [s                      ':                 :                                          :                 ^|[u%CRAFT.6_FOUND%
	ECHO.^|      :.                           .:                 :                                          :                 ^|
	ECHO.^|       :      Infernal Blade       :                  :                                          :                 ^|
	ECHO.^|      :'     [s                      ':                 :              %RGB.FALSE%^(^!^) WARNING ^(^!^)[0m             :                 ^|[u%CRAFT.7_FOUND%
	ECHO.^|      :.                           .:                 :      %RGB.FALSE%BONUS EFFECTS WILL NOT FUNCTION[0m     :                 ^|
	ECHO.^|       :       Ornate Cobalt       :                  :                                          :                 ^|
	ECHO.^|      :'     [s                      ':                 :             - %RGB%229;204;255mITEM HISTORY[0m -             :                 ^|[u%CRAFT.8_FOUND%
	ECHO.^|      :.                           .:                 :                                          :                 ^|
	ECHO.^|       :        Brainleader        :                  :                                          :                 ^|
	ECHO.^|      :'     [s                      ':                 :                                          :                 ^|[u%CRAFT.9_FOUND%
	ECHO.^|      :.                           .:                 :                                          :                 ^|
	ECHO.^|       :                           :                  :                                          :                 ^|
	ECHO.^|      :'- - - - - - - - - - - - - -':                 :-----------.------------------.-----------:                 ^|
	ECHO.^|      :.                           .:                 : -+-+-+-+- ^| Press [1;4mA[0m to craft ^| -+-+-+-+- :                 ^|
	ECHO.^|       :  Use W A S D to navigate  :                  '-----------'------------------'-----------'                 ^|
	ECHO.^|      :'                           ':                                                                              ^|
	ECHO.^|      '-----------------------------'                                                                              ^|
) ELSE ECHO.[1mCRAFT ITEMS[0m
SETLOCAL ENABLEDELAYEDEXPANSION
IF NOT %MAT.1.X%==0 ECHO.[9;56H^> %RGB%204;229;255m%MAT.1.NAME:_= %[0m[10;58H%RGB%255;100;100mReq[0m: [1m%MAT.1.X%[0m / %RGB%204;240;229mOwned[0m: [1m%CRAFT.UI.1.OWNED%[0m
IF NOT %MAT.2.X%==0 ECHO.[12;56H^> %RGB%204;229;255m%MAT.2.NAME:_= %[0m[13;58H%RGB%255;100;100mReq[0m: [1m%MAT.2.X%[0m / %RGB%204;240;229mOwned[0m: [1m%CRAFT.UI.2.OWNED%[0m
IF NOT %MAT.3.X%==0 ECHO.[15;56H^> %RGB%204;229;255m%MAT.3.NAME:_= %[0m[16;58H%RGB%255;100;100mReq[0m: [1m%MAT.3.X%[0m / %RGB%204;240;229mOwned[0m: [1m%CRAFT.UI.3.OWNED%[0m
ECHO.[1m[22;59H%CRAFT.UI.TYPE%[22;87H  !I.%CRAFT.UI_ITEM%.DMG!  [25;58H!I.%CRAFT.UI_ITEM%.DESC_1:_= ![26;58H!I.%CRAFT.UI_ITEM%.DESC_2:_= ![27;58H!I.%CRAFT.UI_ITEM%.DESC_3:_= ![32;58H!I.%CRAFT.UI_ITEM%.HIST_1:_= ![33;58H!I.%CRAFT.UI_ITEM%.HIST_2:_= ![34;58H!I.%CRAFT.UI_ITEM%.HIST_3:_= ![35;58H!I.%CRAFT.UI_ITEM%.HIST_4:_= ![0m
IF %CRAFT.SEL%==3 (ECHO.[%SEL.Y%;37H '---------------'. [1B[20D                  '[1B[19D                    [1B[19D-----------------
) ELSE IF %CRAFT.SEL%==4 (ECHO.[%SEL.Y%;37H '---------------'  [1B[20D                    [1B[20D                    [1B[19D------------------.
) ELSE IF %CRAFT.SEL% GTR 4 (ECHO.[%SEL.Y%;37H '-----------------'[1B[20D                    [1B[20D                    [1B[19D------------------.
) ELSE (ECHO.[%SEL.Y%;37H '---------------'[1B[18D                  [1B[18D                  [1B[17D----------------.)
SET /P "=[3A[13C[1m%CRAFT.UI.CENTER:_= %[u"<NUL
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
IF %CHOICE.INPUT%.==. GOTO CRAFT-SHOP-RE
IF /I %CHOICE.INPUT%==E SET /A SHOP.TAB=1&&GOTO SHOP
IF /I %CHOICE.INPUT%==Q GOTO MENU
IF /I %CHOICE.INPUT%==W IF %CRAFT.SEL% GEQ 1 SET /A CRAFT.SEL-=1&GOTO CRAFT-SHOP-RE
IF /I %CHOICE.INPUT%==S IF %CRAFT.SEL% LEQ 7 SET /A CRAFT.SEL+=1&GOTO CRAFT-SHOP-RE
::IF /I %CHOICE.INPUT%==D IF %CRAFT.NAV% LEQ 0 SET /A CRAFT.NAV+=1&GOTO CRAFT-SHOP-RE
::IF /I %CHOICE.INPUT%==A IF %CRAFT.NAV% GEQ 1 SET /A CRAFT.NAV-=1&GOTO CRAFT-SHOP-RE
IF /I %CHOICE.INPUT%==R (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO SHOP
)
IF /I %CHOICE.INPUT%==A (
	SETLOCAL ENABLEDELAYEDEXPANSION
	IF !WEAPONS.REG_LVL.%CRAFT.UI_ITEM%! GEQ 60 (
		ENDLOCAL
		ECHO.[?25l[1;37m[36H
		ECHO.[63C.--------------------------.
		ECHO.[62C ^|  [1m%RGB.FALSE%Upgrade is maxed out! [0m  ^| 
		ECHO.[63C'------------[1mOK[0m------------'
		PAUSE>NUL
	) ELSE (
		IF %MAT.1.OWNED% GEQ %MAT.1.X% IF %MAT.2.OWNED% GEQ %MAT.2.X% IF %MAT.3.OWNED% GEQ %MAT.3.X% (
			IF NOT %MAT.1.X%==0 CALL "%ITEMS.LOADER%" CRAFT_REM %MAT.1.NAME% %MAT.1.X%
			IF NOT %MAT.2.X%==0 CALL "%ITEMS.LOADER%" CRAFT_REM %MAT.2.NAME% %MAT.2.X%
			IF NOT %MAT.3.X%==0 CALL "%ITEMS.LOADER%" CRAFT_REM %MAT.3.NAME% %MAT.3.X%
			CALL "%ITEMS.LOADER%" REPLACE-MAT %CRAFT.UI_ITEM% 1 WEAPONS
			IF ERRORLEVEL 60 ECHO.%CRAFT.UI_ITEM%$1$0>>"%PLAYERDATA.WEAPONS%"
			
			IF !WEAPONS.REG_LVL.%CRAFT.UI_ITEM%! GEQ 1 (
				ENDLOCAL
				ECHO.[?25l[1;37m[36H
				ECHO.[65C.----------------------.
				ECHO.[64C ^|    [1m%RGB%65;253;254mItem upgraded![0m    ^| 
				ECHO.[65C'----------[1mOK[0m----------'
			) ELSE (
				ENDLOCAL
				ECHO.[?25l[1;37m[36H
				ECHO.[63C.--------------------------.
				ECHO.[62C ^|   [1m%RGB.TRUE%Successfuly crafted![0m   ^| 
				ECHO.[63C'------------[1mOK[0m------------'
			)
			PAUSE>NUL
			GOTO CRAFT-SHOP
		)
		ENDLOCAL
		ECHO.[?25l[1;37m[36H
		ECHO.[63C.--------------------------.
		ECHO.[62C ^|  [1m%RGB.FALSE%You cannot craft this![0m  ^| 
		ECHO.[63C'------------[1mOK[0m------------'
		PAUSE>NUL
	)
)
IF /I %CHOICE.INPUT%.==. START "" "https://github.com/136MasterNR/Battles-of-Batch#shop-44"
GOTO CRAFT-SHOP-RE
:CRAFT-UI-CENTER
SETLOCAL ENABLEDELAYEDEXPANSION
SET "STR=%1"
CALL "%CENTER%" 26
ENDLOCAL&SET "CRAFT.UI.CENTER.%1=%STR%"
EXIT /B 0

:QUESTS
CALL "%QUEST.LOADER%" LOAD
TITLE %TITLE%Quests
CALL "%DATA_SAVES%\QUESTS.cmd"
IF A==A (
ECHO.[?25l[H[0m.--------------------------------------------------.-------------.--------------------------------------------------.
ECHO.^|                                                  ^| SIDE QUESTS ^|                                                  ^|
ECHO.'--------------------------------------------------'------.------'--------------------------------------------------'
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          ^|                                                          
ECHO.                                                          '                                                          
ECHO.                                      [1;37mComplete all quests to unlock new quests![0m                                      
ECHO..---------------------------------------------------------.---------------------------------------------------------.[H
)
CALL "%QUEST.LOADER%" NUL
PAUSE>NUL
GOTO S-MENU
:SETTINGS
CHCP 65001>NUL
CLS
TITLE %TITLE%Settings
ECHO.[?25l[H[0m                                                [4m                    [0m                                                 
ECHO. ╭──────────────────────╥──────────────╥───────[4m┬╯     SETTINGS     ╰┬[0m──────────────────────────────────────────────╮ 
ECHO. │     %RGB%237;244;255mSetting Name[0m     ║    %RGB%237;244;255mStatus[0m    ║                                %RGB%237;244;255mDescription[0m                                │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │     %RGB%187;203;250mMusic ^& SFX[0m      ║              ║    %RGB%194;255;255mTurn on or off the Music and the SFX. Use "audio" to toggle.           │ [88D[s
IF "%DENIED_AUDIO%"=="TRUE" ( ECHO.[u%RGB%195;1;1mΧ LOCKED[0m[8CYour device does not meet the requirements for this feature.) ELSE IF "%AUDIO.VALUE%"=="TRUE" ( ECHO.[u%RGB.TRUE%√ %AUDIO.VALUE%[0m ) ELSE ( ECHO.[u%RGB.FALSE%Χ %AUDIO.VALUE%[0m )
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │     %RGB%187;203;250mMusic Volume[0m     ║              ║    %RGB%194;255;255mAdjust the volume. Use "volume (number)" %RGB.DGRAY%Example: "Volume 50"[0m          │ [86D%RGB%196;255;225m%VOLUME%[0m
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │      %RGB%187;203;250mSFX Volume[0m      ║              ║    %RGB%255;89;89mYet unusable.[0m                                                          │ [86D%RGB%196;255;225m%SFX.VOLUME%[0m
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │      %RGB%187;203;250mAuto Save[0m       ║   %RGB%163;255;177m√ TRUE[0m     ║    %RGB%255;89;89mYet unusable.[0m                                                          │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │       %RGB%187;203;250mUpdater[0m        ║              ║    %RGB%194;255;255mCheck for updates on startup. Use "updates" to toggle.                 │ [88D[s
IF "%UPDATE.VALUE%"=="TRUE" ( ECHO.[u%RGB%163;255;177m√ %UPDATE.VALUE%[0m ) ELSE ( ECHO.[u%RGB%255;89;89mΧ %UPDATE.VALUE%[0m )
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │    %RGB%187;203;250mShortcut Keys[0m     ║              ║    %RGB%194;255;255mPress one key to navigate instead of typing. Use "keys" to toggle.     │ [88D[s
IF "%SHORTCUTS.VALUE%"=="TRUE" ( ECHO.[u%RGB%163;255;177m√ %SHORTCUTS.VALUE%[0m ) ELSE ( ECHO.[u%RGB%255;89;89mΧ %SHORTCUTS.VALUE%[0m )
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │      %RGB%187;203;250mShow Intro[0m      ║              ║    %RGB%194;255;255mWhether to show the HTS intro on startup. Use "intro" to toggle.       │ [88D[s
IF "%SHOW.INTRO%"=="TRUE" ( ECHO.[u%RGB%163;255;177m√ %SHOW.INTRO%[0m ) ELSE ( ECHO.[u%RGB%255;89;89mΧ %SHOW.INTRO%[0m )
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╬══════════════╬═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                      ║              ║                                                                           │ 
ECHO. ╞══════════════════════╩══════════════╩═══════════════════════════════════════════════════════════════════════════╡ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │                                                                                                                 │ 
ECHO. │ ► Type back to return to the menu.                                                                              │ 
ECHO.╭┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────┴╮
ECHO.│                                                                                                                   │
ECHO.╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯[2A
SET UDERFINE=
SET "INPUT_PART=options"
SETLOCAL ENABLEDELAYEDEXPANSION
%INPUT% "PROMPT=[0m│ [0;36mType[0m: [1;37m[s[?25h" "length=107"
ENDLOCAL&SET UDERFINE=%UDERFINE%
ENDLOCAL
SET "INPUT_PART=nul"
 IF NOT DEFINED UDERFINE GOTO SETTINGS
  IF /I "%UDERFINE%"=="BACK" GOTO S-MENU
   IF /I "%UDERFINE%"=="EXIT" GOTO S-MENU
    IF /I "%UDERFINE%"=="GO BACK" GOTO S-MENU
     IF /I "%UDERFINE%"=="MENU" GOTO S-MENU
	  IF /I "%UDERFINE%"=="RETURN" GOTO S-MENU
	   IF /I "%UDERFINE%"=="Q" GOTO S-MENU
 IF /I "%UDERFINE%"=="REFRESH" (MODE CON:COLS=%COLS% LINES=%LINES%&GOTO SETTINGS)
 IF /I "%UDERFINE:~0,5%"=="SOUND" CALL "%SETTING%" AUDIO
  IF /I "%UDERFINE%"=="MUSIC" CALL "%SETTING%" AUDIO
   IF /I "%UDERFINE%"=="PLAY AUDIO" CALL "%SETTING%" AUDIO
	IF /I "%UDERFINE%"=="AUDIO" CALL "%SETTING%" AUDIO
	 IF /I "%UDERFINE%"=="PLAY SOUNDS" CALL "%SETTING%" AUDIO
	  IF /I "%UDERFINE%"=="PLAY MUSIC" CALL "%SETTING%" AUDIO
	   IF /I "%UDERFINE%"=="TURN OFF MUSIC" CALL "%SETTING%" AUDIO
		IF /I "%UDERFINE%"=="TURN ON MUSIC" CALL "%SETTING%" AUDIO
		 IF /I "%UDERFINE%"=="TURN OFF SOUNDS" CALL "%SETTING%" AUDIO
		  IF /I "%UDERFINE%"=="TURN ON SOUNDS" CALL "%SETTING%" AUDIO
		    IF /I "%UDERFINE%"=="TURN OFF AUDIO" CALL "%SETTING%" AUDIO
			 IF /I "%UDERFINE%"=="TURN ON MUSIC" CALL "%SETTING%" AUDIO
 IF /I "%UDERFINE%"=="KEYS" CALL "%SETTING%" SET %SHORTCUTS.VALUE% 6 SHORTCUTS.VALUE
  IF /I "%UDERFINE%"=="SHORTCUT" CALL "%SETTING%" SET %SHORTCUTS.VALUE% 6 SHORTCUTS.VALUE
   IF /I "%UDERFINE%"=="SHORTCUT KEYS" CALL "%SETTING%" SET %SHORTCUTS.VALUE% 6 SHORTCUTS.VALUE
 IF /I "%UDERFINE:~0,6%"=="VOLUME" CALL "%SETTING%" VOLUME
 IF /I "%UDERFINE%"=="UPDATE" CALL "%SETTING%" SET %UPDATE.VALUE% 5 UPDATE.VALUE
  IF /I "%UDERFINE%"=="UPDATES" CALL "%SETTING%" SET %UPDATE.VALUE% 5 UPDATE.VALUE
   IF /I "%UDERFINE%"=="UPDATER" CALL "%SETTING%" SET %UPDATE.VALUE% 5 UPDATE.VALUE
 IF /I "%UDERFINE%"=="INTRO" CALL "%SETTING%" SET %SHOW.INTRO% 7 SHOW.INTRO
  IF /I "%UDERFINE%"=="SHOW" CALL "%SETTING%" SET %SHOW.INTRO% 7 SHOW.INTRO
   IF /I "%UDERFINE%"=="SHOW INTRO" CALL "%SETTING%" SET %SHOW.INTRO% 7 SHOW.INTRO
GOTO SETTINGS
:RESET
TASKKILL /F /FI "WINDOWTITLE eq wscript.exe" /T>NUL 2>NUL
RD /S /Q "%MAIN_GAME%"
GOTO RESTART
:LICENSE
CLS
TYPE Copyright.txt
PAUSE>NUL
GOTO S-MENU
:PRE_LOAD
IF NOT EXIST "%LOAD.LEVEL_%%SELECTED%\setup.cmd" GOTO MAP
ECHO.[2J[21;42H҉  Preparing Your Amazing Battle[17D[1B[s
ECHO.[u  0%%
TITLE %TITLE%Loading Battle ...
IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 TASKKILL /F /FI "WINDOWTITLE eq wscript.exe" /T>NUL 2>NUL
SET "ERRORLEVEL="
SET "ERRORLVL="
IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 TASKLIST /FI "IMAGENAME eq wscript.exe.battle" 2>NUL|FIND /I /N "wscript.exe">NUL&SET "ERRORLVL=%ERRORLEVEL%" & TASKKILL /F /IM wscript.exe.battle>NUL
IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 IF %SELECTED%==7 (SET "TARGETAUDIO=%AUD.BATTLE.BOSS%") ELSE SET "TARGETAUDIO=%AUD.BATTLE.NORMAL%"
IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 (
	IF /I "%ERRORLVL%"=="0" (
		TASKKILL /F /FI "WINDOWTITLE eq wscript.exe.battle" /T>NUL
		(
			ECHO Set Sound = CreateObject^("WMPlayer.OCX.7"^)
			ECHO Sound.URL = "%TARGETAUDIO%"
			ECHO Sound.Controls.play
			ECHO Sound.settings.volume = %VOLUME%
			ECHO Sound.settings.setMode "loop", True
			ECHO Sound.Controls.play
			ECHO While Sound.playState ^<^> 1
			ECHO      WScript.Sleep 100
			ECHO Wend
		) > "%DATA_TMP_A%"
		START /min "wscript.exe.battle" cmd /c START /min /wait "" "%DATA_TMP_A%"^&DEL /Q "%DATA_TMP_A%"^&EXIT
	) ELSE IF /I "%ERRORLVL%"=="1" (
		(
			ECHO Set Sound = CreateObject^("WMPlayer.OCX.7"^)
			ECHO Sound.URL = "%TARGETAUDIO%"
			ECHO Sound.Controls.play
			ECHO Sound.settings.volume = %VOLUME%
			ECHO Sound.settings.setMode "loop", True
			ECHO Sound.Controls.play
			ECHO While Sound.playState ^<^> 1
			ECHO      WScript.Sleep 100
			ECHO Wend
		) > "%DATA_TMP_A%%\TMP_AUDIO.vbs"
		START /min "wscript.exe.battle" cmd /c START /min /wait "" "%DATA_TMP_A%"^&DEL /Q "%DATA_TMP_A%"^&EXIT
	)
)
ECHO.[u 13%%
SET LOAD.ERR=
ECHO.[u 18%%
CALL "%PLAYERSKILLS.LOAD%"
ECHO.[u 22%%
CALL "%ITEMS.LOADER%" LIST
ECHO.[u 27%%
CALL "%ITEMS.LOADER%" LIST_EQ
ECHO.[u 34%%
CALL "%ITEMS.LOADER%" WEAPONS
ECHO.[u 38%%
CALL "%CMD.CLEARVAR%"
ECHO.[u 41%%
CALL "%LOAD.LEVEL_%%SELECTED%\setup.cmd"
IF DEFINED LOAD.ERR GOTO MENU
ECHO.[u 62%%
CALL "%SCRIPTS_GAME%\loader.cmd"
ECHO.[u 96%%
SETLOCAL ENABLEDELAYEDEXPANSION
TITLE %TITLE%!MAP.NAME.%SELECTED%:_= ! (Battle #%SELECTED%)
ENDLOCAL
ECHO.[u100%%
IF EXIST LET.DEBUG (
	CALL "%DEBUG.GAMELOADER%\1"
	GOTO BATTLE-INPUT
)
CLS
:IN-BATTLE
(
ECHO.[?25l[H.--.----------------------------------------------------------------------------------------------------------------.
ECHO.^|Q ^|[113C^|
ECHO.^|--'[113C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.^|[115C^|
ECHO.'-------------------------------------------------------------------------------------------------------------------'[2A
ECHO.[13;3H     ___             
ECHO.[2C    //_\\_          
ECHO.[2C  ."\\    ".        
ECHO.[2C /          \       
ECHO.[2C ^|           \_     
ECHO.[2C ^|       ,--.-.^)    
ECHO.[2C  \     /  o \o\    
ECHO.[2C  /\/\  \    /_/    
ECHO.[2C   (_.   `--'__^)    
ECHO.[2C    ^|     .-'  \    
ECHO.[2C    ^|  .-'.     ^)   
ECHO.[2C    ^| (  _/--.-'    
ECHO.[2C    ^|  `.___.'      
ECHO.[2C    ^|               )

:REFRESH-BATTLE
SET /A A+=1
SET ENEMY.HP.NOW.T=
FOR /L %%I IN (1,1,%EN.MAX%) DO (
	SET /A ENEMY.HP.NOW.T+=ENEMY.HP.NOW.%%I
)
CALL "%SCRIPTS_GAME%\hpbar_now.cmd"
::IF NOT EXIST LET.DEBUG CALL "%IG.CMDS%"
ECHO.[47;3H^|                                                                                                                 ^|[47;3HYour HP: %PLAYER.HP.NOW%/%PLAYER.HP.FULL% ^(+%PLAYER.HEAL.AMOUNT% -%ENEMY.ATTACK.AMOUNT%^)[47;40HYou dealt %PLAYER.ATTACK.AMOUNT% DMG to %PLAYER.ATTACK.ENEMY% - CRIT: %ATK.CRIT%[47;90HEnemy Total HP: %ENEMY.HP.NOW.T%/%ENEMY.HP.FULL.T%
:REFRESH-FADE
IF %ENEMY.HP.NOW.T% LEQ 0 (
	IF %CNT.FADEOUT%==14 (
		CALL "%SCRIPTS_POP%\win.cmd"
		IF "%AUDIO.VALUE%"=="TRUE" IF %VOLUME% NEQ 0 TASKKILL /F /FI "WINDOWTITLE eq wscript.exe.battle" /T>NUL 2>NUL
		CALL "%MENU.AUDIO%"
		GOTO MAP
	)
	HELP>NUL
	HELP>NUL
	IF %CNT.FADEOUT%==0 (
		SET "FADE=[14D="
	) ELSE IF %CNT.FADEOUT%==1 (
		SET "FADE=[14D=="
	) ELSE IF %CNT.FADEOUT%==2 (
		SET "FADE=[14D==="
	) ELSE IF %CNT.FADEOUT%==3 (
		SET "FADE=[14D===="
	) ELSE IF %CNT.FADEOUT%==4 (
		SET "FADE=[14D====="
	) ELSE IF %CNT.FADEOUT%==5 (
		SET "FADE=[14D======"
	) ELSE IF %CNT.FADEOUT%==6 (
		SET "FADE=[14D======="
	) ELSE IF %CNT.FADEOUT%==7 (
		SET "FADE=[14D========"
	) ELSE IF %CNT.FADEOUT%==8 (
		SET "FADE=[14D========="
	) ELSE IF %CNT.FADEOUT%==9 (
		SET "FADE=[14D=========="
	) ELSE IF %CNT.FADEOUT%==10 (
		SET "FADE=[14D==========="
	) ELSE IF %CNT.FADEOUT%==11 (
		SET "FADE=[14D============"
	) ELSE IF %CNT.FADEOUT%==12 (
		SET "FADE=[14D============="
	) ELSE IF %CNT.FADEOUT%==13 (
		SET "FADE=[14D=============="
	)
	SET /A CNT.FADEOUT+=1
	CALL "%SCRIPTS_GAME%\enemy_display.cmd"
	GOTO REFRESH-FADE
)
IF %PLAYER.HP.NOW% LEQ 0 (
	CALL "%SCRIPTS_POP%\lose.cmd"
	IF "%AUDIO.VALUE%"=="TRUE" IF %VOLUME% NEQ 0 TASKKILL /F /FI "WINDOWTITLE eq wscript.exe.battle" /T>NUL 2>NUL
	CALL "%MENU.AUDIO%"
	GOTO MAP
)
SET UDERFINE=
IF "%SHORTCUTS.VALUE%"=="TRUE" (
	GOTO :BATTLE-CHOICE
)
:BATTLE-CHOICE
IF %SELECTED% EQU 1 (
	ECHO.[2;45H[s:---------: HELP - ^? :---------:
	ECHO.[u[1B: %RGB.COIN%Select an enemy to attack:[0m   :
	ECHO.[u[2B: Navigate using %RGB.CYAN%W[0m and %RGB.CYAN%S[0m, then[0m :
	ECHO.[u[3B: press %RGB.CYAN%A[0m to make your action![0m :
	ECHO.[u[4B:------------------------------:
)

IF "%INV.SEL_NAME%"=="EMPTY" (
	ECHO.[42;4H[s                                                          
	ECHO.[u[1B:----------------------------------------------:      
	ECHO.[u[2B  %RGB.ORANGE%No item selected[0m, press %RGB.CYAN%E[0m to choose an item. 
	ECHO.[u[3B:----------------------------------------------:      
) ELSE IF NOT DEFINED INV.SEL_NAME (
	ECHO.[42;4H[s                                                          
	ECHO.[u[1B:---------------------------------------------:      
	ECHO.[u[2B  %RGB.ORANGE%To use an item[0m, first press %RGB.CYAN%E[0m to select it.
	ECHO.[u[3B:---------------------------------------------:      
) ELSE (
	ECHO.[42;4H[s:---------------------------------------------------:
	SETLOCAL ENABLEDELAYEDEXPANSION
	IF "%INV.SEL_NAME%"=="ATTACK" (ECHO.[u[1B  [1mPress %RGB.CYAN%A[0m[1m to strike the enemy using %RGB.COIN%!WEAPONS.REG_NAME.%WIELDING.WEAPON%:_= ![0m[1m.                          
	) ELSE ECHO.[u[1B  [1mPress %RGB.CYAN%A[0m[1m to use %RGB.COIN%%INV.SEL_NAME%[0m[1m on the chosen enemy.                          
	ENDLOCAL
	ECHO.[u[2B  Press %RGB.CYAN%E[0m to change the selected action.      
	ECHO.[u[3B:---------------------------------------------------:       
)

SETLOCAL ENABLEDELAYEDEXPANSION
IF !ENEMY.HP.NOW.%INPUTATK%! EQU 0 (
	ENDLOCAL
	CALL "%SCRIPTS_GAME%\rand_enemy.cmd"
) ELSE ENDLOCAL
:BATTLE-SEL_CHOICE
CALL :BATTLE-DISPLAY_CHOICE
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
ECHO.%TMP.LOC_HP_OLD%[4B[2D   [1B[3D   [1A[10C              %TMP.LOC_HP_OLD%[11C[3B              [0m%TMP.LOC_HP_OLD%[11C[2B              
IF %CHOICE.INPUT%.==. GOTO BATTLE-SEL_CHOICE
IF /I %CHOICE.INPUT%==Q (
	IF %AUDIO.VALUE%==TRUE IF %VOLUME% NEQ 0 (
		TASKKILL /F /FI "WINDOWTITLE eq wscript.exe.battle" /T>NUL 2>NUL
		CALL "%MENU.AUDIO%"
	)
	GOTO MAP
)
IF /I %CHOICE.INPUT%==S (
	CALL :BATTLE-S_CHOICE
	CALL :BATTLE-DISPLAY_CHOICE
)
IF /I %CHOICE.INPUT%==W (
	CALL :BATTLE-W_CHOICE
	CALL :BATTLE-DISPLAY_CHOICE
)

IF /I %CHOICE.INPUT%==Z IF "%SEL.CHARACTER%"=="SIMPSONS" (
	ECHO.%TMP.LOC_HP_OLD%[4B[2D   [1B[3D   [1A[10C              %TMP.LOC_HP_OLD%[11C[3B              [0m%TMP.LOC_HP_OLD%[11C[2B              
	CALL "%CMD.CLEARVAR%"
	CALL "%ACT.SIMPSONS.LASER%" || CALL :ERROR ERRLINE ID01.inGameLASER    -0
	%ADD-CMD%
	GOTO REFRESH-BATTLE
)
IF /I %CHOICE.INPUT%== START "" "https://github.com/136MasterNR/Battles-of-Batch#battle-42"

IF /I %CHOICE.INPUT%==R (
	MODE CON:COLS=%COLS% LINES=%LINES%
	GOTO IN-BATTLE
)

IF /I %CHOICE.INPUT%==A (
	IF NOT DEFINED INV.SEL_NAME (
		ECHO.[41;14H%RGB.RED%You haven't selected an action!
		PAUSE>NUL
		ECHO.[41;14H                               
	) ELSE IF "%INV.SEL_NAME%"=="EMPTY" (
		ECHO.[41;14H%RGB.RED%You haven't selected an action!
		PAUSE>NUL
		ECHO.[41;14H                               
	) ELSE (
		CALL "%CMD.CLEARVAR%"
		CALL "%SCRIPTS_GAME%\act.cmd" %INV.SEL_NAME% || CALL :ERROR ERRLINE ID01.inBattleACT    -0
		GOTO REFRESH-BATTLE
	)
)
IF /I %CHOICE.INPUT%==E (
	GOTO BATTLE-INVENTORY
)

IF /I %CHOICE.INPUT%==N (
	CALL "%CMD.CLEARVAR%"
	CALL "%ACT.ENEMY_ATK%"
	GOTO REFRESH-BATTLE
)
GOTO BATTLE-SEL_CHOICE
:BATTLE-INVENTORY
COLOR 08
:BATTLE-INVENTORY_RE
CALL "%IG.CMDS%" INVENTORY
SETLOCAL ENABLEDELAYEDEXPANSION
%CHOICE%
ENDLOCAL&SET CHOICE.INPUT=%ERRORLEVEL%
IF /I %CHOICE.INPUT%==S (
	IF %INV.SEL% LSS %ITEM.EQ_CNT% (SET /A INV.SEL+=1) ELSE SET /A INV.SEL=0
	GOTO BATTLE-INVENTORY_RE
)
IF /I %CHOICE.INPUT%==W (
	IF %INV.SEL% LEQ 0 (SET /A INV.SEL=%ITEM.EQ_CNT%) ELSE SET /A INV.SEL-=1
	GOTO BATTLE-INVENTORY_RE
)
SET "TMP.SPACES=                        "
ECHO.[u%TMP.SPACES%[u[1B%TMP.SPACES%[u[2B%TMP.SPACES%[u[3B%TMP.SPACES%[u[4B%TMP.SPACES%[u[5B%TMP.SPACES%[u[6B%TMP.SPACES%[u[7B%TMP.SPACES%[u[8B%TMP.SPACES%[u[9B%TMP.SPACES%[u[10B%TMP.SPACES%[u[11B%TMP.SPACES%[u[12B%TMP.SPACES%[u[13B%TMP.SPACES%[u[14B%TMP.SPACES%[u[15B%TMP.SPACES%[u[17B%TMP.SPACES%   [u[18B%TMP.SPACES%    
GOTO IN-BATTLE

:BATTLE-S_CHOICE
SETLOCAL ENABLEDELAYEDEXPANSION
IF %INPUTATK% GTR %EN.MAX% (SET INPUTATK=1) ELSE SET /A INPUTATK+=1
:BATTLE-S_CHOICE-RE
IF !ENEMY.HP.NOW.%INPUTATK%! EQU 0 IF %INPUTATK% GTR %EN.MAX% (SET INPUTATK=1) ELSE (
	SET /A INPUTATK+=1
	GOTO BATTLE-S_CHOICE-RE
)
IF !ENEMY.HP.NOW.%INPUTATK%! EQU 0 GOTO :BATTLE-S_CHOICE-RE
ENDLOCAL&&SET INPUTATK=%INPUTATK%
EXIT /B 0
:BATTLE-W_CHOICE
SETLOCAL ENABLEDELAYEDEXPANSION
IF %INPUTATK% LSS 1 (SET INPUTATK=%EN.MAX%) ELSE SET /A INPUTATK-=1
:BATTLE-W_CHOICE-RE
IF !ENEMY.HP.NOW.%INPUTATK%! EQU 0 IF %INPUTATK% LSS 1 (
	SET INPUTATK=%EN.MAX%
) ELSE (
	SET /A INPUTATK-=1
	GOTO BATTLE-W_CHOICE-RE
)
IF !ENEMY.HP.NOW.%INPUTATK%! EQU 0 GOTO :BATTLE-W_CHOICE-RE
ENDLOCAL&&SET INPUTATK=%INPUTATK%
EXIT /B 0
:BATTLE-DISPLAY_CHOICE
SETLOCAL ENABLEDELAYEDEXPANSION
IF DEFINED TMP.LOC_HP_OLD (
	ECHO.%TMP.LOC_HP_OLD%[4B[2D   [1B[3D   [1A[10C              %TMP.LOC_HP_OLD%[11C[3B              [0m%TMP.LOC_HP_OLD%[11C[2B              
)
SET TMP.LOC_HP_OLD=!LOC.HP.%INPUTATK%!
FOR /F "TOKENS=1-2 DELIMS=," %%A IN ("!ENEMY.ATK.AMOUNT.%INPUTATK%!") DO (
	SET /A "ENEMY.MAXP_ATK=%%A+%%B"
	SET /A "ENEMY.MINP_ATK=%%A"
)
ECHO.!LOC.HP.%INPUTATK%![4B[2D[4m^|[0m [0m^>[1B[3D' ^>[1A[10C%RGB%245;151;151mAtk: [0m!ENEMY.MINP_ATK!~!ENEMY.MAXP_ATK!!LOC.HP.%INPUTATK%![11C[3B%RGB%176;225;187mHP: [0m!ENEMY.HP.NOW.%INPUTATK%!!LOC.HP.%INPUTATK%![11C[2B%RGB.CYAN%Lvl: [0m!ENEMY.LVL.%INPUTATK%!
ENDLOCAL&&SET TMP.LOC_HP_OLD=%TMP.LOC_HP_OLD%
EXIT /B 0
:ERROR <resultVar> <uniqueID> [LineOffset]
IF "%IGNORE_ERRORS%"=="TRUE" GOTO :EOF
IF DEFINED VERCODE (
	IF NOT DEFINED AUDIO.VALUE CALL :SETT_ERR
	IF NOT DEFINED VOLUME CALL :SETT_ERR
	IF NOT DEFINED SFX.VOLUME CALL :SETT_ERR
	IF NOT DEFINED AUTOSAVE.VALUE CALL :SETT_ERR
	IF NOT DEFINED UPDATE.VALUE CALL :SETT_ERR
	IF NOT DEFINED SHORTCUTS.VALUE CALL :SETT_ERR
	IF NOT DEFINED SHOW.INTRO CALL :SETT_ERR
)
SET "ERR.CODE=%ERRORLEVEL%"
CLS
COLOR 0C
TITLE CRASH
SETLOCAL
FOR /F "USEBACKQ TOKENS=1 DELIMS=:" %%L IN (`FINDSTR /N "%~2" "%~f0"`) DO set /a LINENR=%~3 + %%L
SET "INF_ERR=%~2"
( 
	ENDLOCAL
	SET "%~1=%LINENR%"
	ECHO.There was a fatal error while running.
	ECHO.
	ECHO.Please contact the developers and send this:
	ECHO.- Error Information -
	ECHO. Err Code: '%ERR.CODE%'
	ECHO. Err Info: '%INF_ERR:~0,2%:%INF_ERR:~2%'
	SETLOCAL ENABLEDELAYEDEXPANSION
	ECHO. At Line: '!%~1!'
	ENDLOCAL
	ECHO.
	ECHO.
	ECHO.[1;33mPlease do not contact the developers unless you have NOT touched anything in the files.
	ECHO.In that matter, you should download and extract the game again.
	ECHO.
	ECHO.[0;37mPress any key to verify file indetity ...
	PAUSE>NUL
	CALL :VERIFY-FILE-IDENTITY
	EXIT 1
)
EXIT 1
:SETT_ERR
CLS
ECHO.Found errors in your options!
ECHO.Press any key to reset them.
PAUSE>NUL
DEL /Q "%DATA_SETTINGS%\settings.cmd"
GOTO RESTART
:VERIFY-FILE-IDENTITY
CLS
ECHO.Preparing file identity verification...
SET /A NEW.CNT=0
SET /A DIF.CNT=0
SET /A DUP.CNT=0
SET /A MIS.CNT=0
SET "UPDATE.LOC=%DATA_TMP%\update.cmd"
SET "UPDZIP.LOC=%tmp%\update.zip"
SET "EXTRAC.LOC=%TMP%\bob"
BREAK>".\data\logs\verify-file-identity.log"
CURL -S "https://136masternr.github.io/HTS-Studios/get-update/battlesofbatch.bat" --SSL-NO-REVOKE >"./data/temp/update.cmd"
>NUL FIND /I "SET UPDATE.VER=" ".\data\temp\update.cmd" && (
	CALL "%UPDATE.LOC%"
	DEL /Q "%UPDATE.LOC%"
)||(
	FOR %%R IN ("%UPDATE.LOC%") DO IF %%~zR LSS 1 ( ECHO.VERIFIER: Failed to download latest update because the information was not found.
	) ELSE ( ECHO.VERIFIER: Failed to download latest update because the information was not recognized. )
	SET OUTOFDATE=UNRE
	IF EXIST "%UPDATE.LOC%" DEL /Q "%UPDATE.LOC%"
	GOTO :EOF
)
CURL -S "%UPDATE.URL%" --SSL-NO-REVOKE >"%UPDZIP.LOC%"
CALL :UNZIPFILE "%EXTRAC.LOC%" "%UPDZIP.LOC%"
SETLOCAL ENABLEDELAYEDEXPANSION

SET "Folder1=%CD%"
SET "Folder2=%EXTRAC.LOC%"

FOR /R "%Folder1%" %%x In (*.*) Do (
	SET /A TOTALFOUNDFILES+=1
    SET "FullPath=%%x"
    SET "RelPath=!FullPath:%Folder1%=!"

    IF EXIST "%Folder2%!RelPath!" (
      >NUL 2>&1 FC /b "%Folder1%!RelPath!" "%Folder2%!RelPath!" && (
       ECHO.Verified - %%x >>".\data\logs\verify-file-identity.log"
	   SET /A DUP.CNT+=1
      )||(
       ECHO.Corrupt  - %%x >>".\data\logs\verify-file-identity.log"
	   SET /A DIF.CNT+=1
      )
    ) ELSE (
      ECHO.New File - %%x >>".\data\logs\verify-file-identity.log"
	  SET /A NEW.CNT+=1
    )
)

FOR /R "%Folder2%" %%x IN (*.*) DO (

    SET "FullPath=%%x"
    SET "RelPath=!FullPath:%Folder2%=!"

    IF NOT EXIST "%Folder1%!RelPath!" (
      ECHO.Missing - %Folder1%!RelPath! >>".\data\logs\verify-file-identity.log"
	  SET /A MIS.CNT+=1
    )
)
RD /S /Q "%EXTRAC.LOC%"

ECHO.Found %NEW.CNT% new files.
ECHO.Found %DIF.CNT% corrupt files.
ECHO.Found %MIS.CNT% missing files.
ECHO.Found %DUP.CNT% verified files.
START "" ".\data\logs\verify-file-identity.log"
ECHO.
ECHO.
ENDLOCAL
ECHO.Press any key to exit.
PAUSE>NUL
GOTO :EOF
:UNZIPFILE
SET VBS="%TMP%\_.VBS"
IF EXIST "%VBS%" DEL /F /Q "%VBS%"
>%VBS% ECHO Set fso = CreateObject("Scripting.FileSystemObject")
>>%VBS% ECHO If NOT fso.FolderExists(%1) Then
>>%VBS% ECHO fso.CreateFolder(%1)
>>%VBS% ECHO End If
>>%VBS% ECHO set objShell = CreateObject("Shell.Application")
>>%VBS% ECHO set FilesInZip=objShell.NameSpace(%2).items
>>%VBS% ECHO objShell.NameSpace(%1).CopyHere(FilesInZip)
>>%VBS% ECHO Set fso = Nothing
>>%VBS% ECHO Set objShell = Nothing
CSCRIPT //NOLOGO "%VBS%"

:EOF
EXIT /B 0